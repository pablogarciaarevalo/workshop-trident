(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"+oIK":function(e,t,n){"use strict";n.d(t,"a",function(){return b}),n.d(t,"b",function(){return p});var a=n("nfbA"),r=n("LeJ0"),c=n("QtlZ"),i=n("LVcX"),o=n("hm8b"),u=n("i9gz"),s=n("MFhO"),d=n("PjZB"),l=n("0lfv"),f={widgetVersion:2,widgetRelease:"LOCAL"!==r.a.ENV?"___RELEASE_ID":"local"},b=function createMessage(e){var t=e.message,n=void 0===t?"":t,r=e.activeConversation,b=e.attributes,p=void 0===b?{}:b,v=e.isMetaMessage,E=void 0!==v&&v,g=e.authorId,m=e.attachments,I=void 0===m?[]:m,j=e.preMessages,_=void 0===j?[]:j,h=e.inboxId,y=e.type,C=void 0===y?d.e.CHAT:y,A=e.contentType,S=void 0===A?d.c.CHAT:A,T=c.a.getState(),x=Object(i.a)({context:{}},["session"],T),k=Object(i.a)(d.b.LEAD,["session","endUser","type"],T),R=Object(i.a)(null,["campaigns","activeCampaign"],T),M=Object(i.a)({},["embed","configuration"],T),w=M.autoAssigneeId,N=M.profileMode,D=void 0!==N&&N,V=c.a.getState().session.assignedAgentId,L=w||V,P=O(h),U=Object(o.a)(_)||Object(u.a)(_)?function _applyPremessagesForMessage(e,t){var n=Object(i.a)({},["embed","configuration"],c.a.getState()),a=n.autoAssigneeId,r=n.profileMode,o=void 0!==r&&r,u=n.team,d=n.theme,l=void 0===d?{}:d,f=c.a.getState().session.assignedAgentId,b=a||f,p=Object(i.a)(null,["attributes","campaignDisplayType"],t)===s.a.WELCOME_MESSAGE,v=Object(i.a)("",["attributes","message"],t),O=Object(i.a)(null,["attributes","senderId"],t),E=[];if(e)return E;if(o&&b&&E.push({body:l.welcomeMessage,sender:u.find(function(e){return e.id===b})}),p){var g=b||O;E.push({body:v,sender:u.find(function(e){return e.id===g})})}return E}(r,R):_;return{attachments:I,conversationId:r,body:n,type:C,contentType:S,authorId:g,authorType:k,inboxId:P,attributes:Object(a.a)(Object(a.a)({},p),{},{widgetGuid:Object(l.p)(),isMetaMessage:E,generatedAt:Date.now().valueOf(),autoAssigneeId:L,profileMode:D,preMessages:U},f),context:{userAgent:x.context.userAgent,timezone:x.context.timezone,locale:x.context.locale,page:x.context.page}}},p=function createPreMessagesForCampaign(e){var t=e.body,n=e.attributes,a=(n=void 0===n?{}:n).title,r=void 0===a?null:a,c=n.senderId,i=void 0===c?null:c,o=n.noSenderId,u=void 0!==o&&o,d=n.automaticSender,f=void 0!==d&&d,b=n.campaignDisplayType,p=(void 0===b?null:b)===s.a.WELCOME_MESSAGE,O=v(i,u,f),E=[];return r&&!p&&E.push({id:Object(l.p)(),body:r,sender:O}),t&&E.push({id:Object(l.p)(),body:t,sender:O}),E},v=function getSender(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t)return null;var a=Object(i.a)({},["embed","configuration"],c.a.getState()),r=a.autoAssigneeId,o=a.team,u=c.a.getState().session.assignedAgentId,s=r||u;return n&&s?o.find(function(e){return e.id===s}):o.find(function(t){return t.id===e})},O=function resolveInboxIdForMessage(e){var t=c.a.getState(),n=Object(i.a)({},["embed","configuration"],t).inboxId;if(!Object(o.a)(e))return e;var a=Object(i.a)(null,["conversations","activeConversation"],t),r=Object(i.a)(null,["conversations","conversations",a,"conversation"],t);return Object(o.a)(r)?n:r.inboxId}},"/7QA":function(e,t,n){"use strict";n.r(t);n("pNMO"),n("DEfu"),n("I9xj"),n("kSko"),n("zKZe"),n("uL8W"),n("Eqjn"),n("HRxU"),n("eoL8"),n("5xtp"),n("T63A"),n("3KgV"),n("wfmh"),n("5DmW"),n("27RR"),n("cDke"),n("NBAS"),n("Kxld"),n("yQYn"),n("4h0Y"),n("5D5o"),n("tkto"),n("v5b1"),n("W/eh"),n("zuhW"),n("r5Og"),n("ExoC"),n("07d7"),n("B6y2"),n("5s+n"),n("p532"),n("PKPk"),n("66V8"),n("8go2"),n("DrvE"),n("kCkZ"),n("3bBZ");var a=n("GMUs"),r=n("Nlet");Object(a.a)(function kickOff(){Object(r.a)(),Promise.all([n.e(34),n.e(32),n.e(23),n.e(30)]).then(n.bind(null,"V+70")).catch(function(e){return console.warn("loading root widget failed",e)})})},"9ttK":function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o});var a=n("WwEg"),r=n("QtlZ"),c=(n("SFoa"),n("da4L"),n("LVcX")),i=function getAttributeFromCampaignOrDefault(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Object(c.a)(n,["attributes"].concat(Object(a.a)(t)),e)},o=function getCampaignFromEmbedById(e){return Object(c.a)([],["embed","configuration","campaigns"],r.a.getState()).filter(function(t){return t.id===e})[0]}},BAMi:function(e,t,n){"use strict";var a=n("s8DI"),r=n("WwEg"),c=n("nfbA"),i=n("mj2O"),o=n.n(i),u=n("7SM1"),s=n("Maj3"),d=n("LVcX"),l=n("K0Zh"),f=n("gG69"),b=n("0lfv"),p=n("7oto"),v=n("Jstd"),O=n("4Zd6"),E=n("EQxi"),g=function isAnyOf(e,t){return Object(v.a)(function(e){return t===e})(e)},m=function notIsAnyOf(e,t){return!g(e,t)},I=function is(e,t){return e===t},j=function notIs(e,t){return e!==t},_=function lessThan(e,t){return t<e},h=function greaterThan(e,t){return t>e},y=function isBetween(e,t){return!!e.min&&!!e.max&&t>=e.min&&t<=e.max},C=function includesAnyOf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object(v.a)(function(e){return-1!==t.indexOf(e)})(e)},A=function notIncludesAnyOf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object(O.a)(function(e){return-1===t.indexOf(e)})(e)},S={device:{async:!1,selector:function selector(e){return function resolveDeviceType(e){var t=e.toLowerCase();return t.match(/(mobi|phone|ipod|blackberry|docomo|iphone|android)/i)?"mobile":t.match(/(ipad|kindle)/i)?"tablet":"desktop"}(Object(d.a)("",["_window","userAgent"])(e))},operands:{isAnyOf:g,notIsAnyOf:m}},siteVisits:{async:!1,selector:function selector(e){return Object(d.a)(0,["visitInformation","total"])(e)},transformValueFn:function transformValueFn(e){return parseInt(e,10)||0},operands:{is:I,notIs:j,lessThan:_,greaterThan:h,isBetween:y}},daysSinceLastVisit:{async:!1,selector:function selector(e){return Object(d.a)(0,["visitInformation","daysSinceLastVisit"])(e)},transformValueFn:function transformValueFn(e){return parseInt(e,10)||0},operands:{is:I,notIs:j,lessThan:_,greaterThan:h,isBetween:y}},referrer:{async:!1,transformValueFn:function transformValueFn(e){return e.map(function(e){return Object(E.e)(e)})},selector:function selector(e){return Object(E.e)(Object(d.a)("",["referrer"])(e))},operands:{is:I,notIs:j,isAnyOf:g,notIsAnyOf:m,includesAnyOf:C,notIncludesAnyOf:A}},cookie:{async:!1,selector:function selector(e){return Object.entries(Object(d.a)({},["cookies"])(e)).map(function(e){return e.join("=")})},operands:{is:I,notIs:j,isAnyOf:g,notIsAnyOf:m,includesAnyOf:C,notIncludesAnyOf:A}},scrollPct:{async:!0,eventType:"scroll",transformValueFn:function transformValueFn(e){return parseInt(e,10)||0},selector:function selector(e){var t=Object(d.a)(0,["_window","scrollY"])(e);return(Object(d.a)(0,["_window","innerHeight"])(e)+t)/Object(d.a)(0,["scrollableHeight"])(e)*100},operands:{lessThan:_,greaterThan:h,isBetween:y}},secondsOnPage:{async:!0,timer:!0,eventType:"timer",selector:function selector(e){var t=Object(d.a)(0,["_window","drift_page_view_started"])(e);return Math.floor((new Date).getTime()/1e3)-t},transformValueFn:function transformValueFn(e){return parseInt(e,10)||0},operands:{lessThan:_,greaterThan:h}},secondsOnSite:{async:!0,timer:!0,eventType:"timer",transformValueFn:function transformValueFn(e){return parseInt(e,10)||0},selector:function selector(e){var t=Object(d.a)(0,["_window","drift_session_started"])(e);return Math.floor((new Date).getTime()/1e3)-t},operands:{lessThan:_,greaterThan:h}},exitIntent:{async:!1,selector:function selector(e){return!1},operands:{is:I}},outboundSession:{async:!1,selector:function selector(e){return Object(d.a)(!1,["session","isOutbound"])(e)},operands:{is:I,notIs:j}},autoAssigneeId:{async:!1,selector:function selector(e){return Object(d.a)("",["embed","configuration","autoAssigneeId"])(e)},operands:{is:I,notIs:j,isAnyOf:g,notIsAnyOf:m}},inboxId:{async:!1,selector:function selector(e){return Object(d.a)("",["embed","configuration","inboxId"])(e)},operands:{isAnyOf:g,notIsAnyOf:m}}},T=function isUnsupportedCondition(e){return!S[e.field]},x=function(){var e=Object(u.a)(o.a.mark(function _callee(e,t){var n,a,r,c,i,u;return o.a.wrap(function _callee$(o){for(;;)switch(o.prev=o.next){case 0:if(!T(e)){o.next=2;break}return o.abrupt("return",Promise.resolve({conditionEvaluation:!1,conditionEvalDetail:{evaluatedCondition:e,matched:!1,status:"PENDING"}}));case 2:return n=S[e.field],a=n.operands[e.operator],r=n.transformValueFn?n.transformValueFn(e.value):e.value,o.next=7,n.selector(t,e);case 7:return c=o.sent,i=a(r,c),u={evaluatedCondition:e,matched:i,actualValue:c,status:n.async?i?"EVALUATED":"PENDING":"EVALUATED"},o.abrupt("return",Promise.resolve({conditionEvaluation:i,conditionEvalDetail:u}));case 11:case"end":return o.stop()}},_callee)}));return function evaluateSingleCondition(t,n){return e.apply(this,arguments)}}(),k=function conditionEvaluator(e){return function(t){return x(e,t)}},R=function(){var e=Object(u.a)(o.a.mark(function _callee3(e){var t,n,a,r,c,i,s,d,l,f,b,p,v,O,E;return o.a.wrap(function _callee3$(g){for(;;)switch(g.prev=g.next){case 0:t=e.context,n=e.conditions,a=!1,r=[],c=[],i=function(){var e=Object(u.a)(o.a.mark(function _callee2(e){var n,a,c,i,u,s,d,l,f,b,p,v,O,E,g;return o.a.wrap(function _callee2$(m){for(;;)switch(m.prev=m.next){case 0:n=!0,a=[],m.t0=o.a.keys(e);case 3:if((m.t1=m.t0()).done){m.next=23;break}return c=m.t1.value,i=e[c],m.next=8,x(i,t);case 8:if(u=m.sent,s=u.conditionEvalDetail,d=u.conditionEvaluation,a.push(s),d||T(s.evaluatedCondition)){m.next=21;break}if(l=S[i.field],f=l.async,b=void 0!==f&&f,p=l.eventType,v=void 0===p?null:p,O=l.timer,E=void 0!==O&&O,g=l.selector,n=!1,!b){m.next=19;break}r.push({conditionDefinition:i,selector:g,eventType:v,timer:E,type:i.field,evaluator:k(i)}),m.next=21;break;case 19:return r=[],m.abrupt("break",23);case 21:m.next=3;break;case 23:return m.abrupt("return",Promise.resolve({fullGroupMatch:n,groupEval:{targetingConditions:a,status:r.length?"PENDING":"EVALUATED"}}));case 24:case"end":return m.stop()}},_callee2)}));return function evaluateConditions(t){return e.apply(this,arguments)}}(),s=!0,d=!1,l=void 0,g.prev=8,f=n[Symbol.iterator]();case 10:if(s=(b=f.next()).done){g.next=25;break}return p=b.value,g.next=14,i(p);case 14:if(v=g.sent,O=v.fullGroupMatch,E=v.groupEval,c.push(E),!O){g.next=22;break}return a=!0,r=[],g.abrupt("break",25);case 22:s=!0,g.next=10;break;case 25:g.next=31;break;case 27:g.prev=27,g.t0=g.catch(8),d=!0,l=g.t0;case 31:g.prev=31,g.prev=32,s||null==f.return||f.return();case 34:if(g.prev=34,!d){g.next=37;break}throw l;case 37:return g.finish(34);case 38:return g.finish(31);case 39:return g.abrupt("return",Promise.resolve({matched:a,asyncConditionListeners:r,evalLog:c}));case 40:case"end":return g.stop()}},_callee3,null,[[8,27,31,39],[32,,34,38]])}));return function evaluateTargetingConditions(t){return e.apply(this,arguments)}}(),M=n("IpSJ"),w=n("FAmh");n.d(t,"b",function(){return H}),n.d(t,"c",function(){return G}),n.d(t,"d",function(){return F}),n.d(t,"a",function(){return B});var N=["secondsOnSite","secondsOnPage","scrollPct","exitIntent"],D=function _addEvaluationResultToAuditLog(e){var t=e.auditLog,n=e.isServerGenerated,a=void 0===n||n,r=e.evaluationResults,c=e.didMatch,i=e.campaignId,o=e.priority,u=e.status,s=void 0===u?f.b.EVALUATED:u;if(t.conditionGroups){var d=a?L(r):r;t.conditionGroups.push({status:s,matched:c,conditionSets:d,key:i,priority:o})}},V=function(){var e=Object(u.a)(o.a.mark(function _callee(e){var t,n,a,r;return o.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return t=e.filter(function(e){return!e.allConditionsFullyEvaluated&&e.allConditionsPotentiallyMatched}),n=t.map(function(e){return e.evaluatedTargetConditionSet}),a=n.map(function(e){return e.filter(function(e){return!e.fullyEvaluated}).map(function(e){return e.evaluatedTargetCondition}).map(function(e){return e.condition})}),c.next=5,Object(M.b)();case 5:return r=c.sent,c.next=8,R({conditions:a,context:r});case 8:return c.abrupt("return",c.sent);case 9:case"end":return c.stop()}},_callee)}));return function _evaluateTargetingForEvaluationResults(t){return e.apply(this,arguments)}}(),L=function _generateAuditLogForServerEvaluationResults(e){return Object(s.a)(function(e){return e.evaluatedTargetConditionSet},e).map(function(e){return U(e)})},P=function(){var e=Object(u.a)(o.a.mark(function _callee3(e){var t,n,a,r,c,i,s=arguments;return o.a.wrap(function _callee3$(d){for(;;)switch(d.prev=d.next){case 0:if(t=s.length>1&&void 0!==s[1]?s[1]:function(){},n=Object(b.p)(),a=function(){var a=Object(u.a)(o.a.mark(function _callee2(){var a;return o.a.wrap(function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(M.b)();case 2:return a=r.sent,r.next=5,e.evaluator(a);case 5:if(r.sent.conditionEvaluation){r.next=8;break}return r.abrupt("return");case 8:e.eventType&&(Object(p.a)({topic:"remove-host-event-listener",message:{id:n,event:e.eventType}}),t());case 9:case"end":return r.stop()}},_callee2)}));return function asyncConditionHandler(){return a.apply(this,arguments)}}(),!e.timer){d.next=12;break}return d.next=6,Object(M.b)();case 6:r=d.sent,c=e.conditionDefinition.value,(i=c-e.selector(r))>0&&setTimeout(a,1e3*i+1e3),d.next=13;break;case 12:Object(p.a)({topic:"add-host-event-listener",message:{id:n,event:e.eventType,handler:a}});case 13:case"end":return d.stop()}},_callee3)}));return function _waitForCondition(t){return e.apply(this,arguments)}}(),U=function _generateAuditLogResultForConditionSet(e){var t=Object(d.a)(null,["evaluatedTargetCondition","condition"],e),n=Object(d.a)(!1,["evaluatedTargetCondition","matched"],e),a=Object(d.a)(null,["evaluatedTargetCondition","actualValue"],e);return{status:f.b.EVALUATED,targetingConditions:[{evaluatedCondition:t,matched:n,actualValue:a,status:f.b.EVALUATED,meta:{}}]}},H=function(){var e=Object(u.a)(o.a.mark(function _callee4(e){var t,n,a,i,u,s,d,b,p,v,O,E,g,m,I;return o.a.wrap(function _callee4$(o){for(;;)switch(o.prev=o.next){case 0:if(e&&e.length){o.next=2;break}return o.abrupt("return",null);case 2:t=Object(c.a)({conditionGroups:[]},Object(w.c)()),n=!0,a=!1,i=void 0,o.prev=6,u=e[Symbol.iterator]();case 8:if(n=(s=u.next()).done){o.next=32;break}if((d=s.value).status!==f.b.EVALUATED||!d.matched){o.next=14;break}t.conditionGroups.push(d),o.next=29;break;case 14:if(d.status!==f.b.PENDING){o.next=29;break}return b=d.conditionSets.filter(function(e){return e.status===f.b.PENDING}).map(function(e){return e.targetingConditions}),p=b.map(function(e){return e.filter(function(e){return e.status===f.b.PENDING}).map(function(e){return e.evaluatedCondition})}),v=b.map(function(e){return e.filter(function(e){return e.status===f.b.EVALUATED})}),O=Object(l.a)(v),o.next=21,Object(M.b)();case 21:return E=o.sent,o.next=24,R({conditions:p,context:E});case 24:g=o.sent,m=g.matched,I=g.evalLog,O.length&&(I[0].targetingConditions=[].concat(Object(r.a)(I[0].targetingConditions),Object(r.a)(O))),t.conditionGroups.push({status:f.b.EVALUATED,matched:m,conditionSets:I,key:d.key,priority:d.priority});case 29:n=!0,o.next=8;break;case 32:o.next=38;break;case 34:o.prev=34,o.t0=o.catch(6),a=!0,i=o.t0;case 38:o.prev=38,o.prev=39,n||null==u.return||u.return();case 41:if(o.prev=41,!a){o.next=44;break}throw i;case 44:return o.finish(41);case 45:return o.finish(38);case 46:return o.abrupt("return",t);case 47:case"end":return o.stop()}},_callee4,null,[[6,34,38,46],[39,,41,45]])}));return function evaluateConditionalSkillTargetingConditions(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(u.a)(o.a.mark(function _callee5(e){var t,n,a,r,c,i,u,s,d;return o.a.wrap(function _callee5$(o){for(;;)switch(o.prev=o.next){case 0:if(e&&e.length){o.next=2;break}return o.abrupt("return",[]);case 2:t=[],n=function toMatchedRule(e){return{id:e.ruleId,priority:e.priority}},a=!0,r=!1,c=void 0,o.prev=7,i=e[Symbol.iterator]();case 9:if(a=(u=i.next()).done){o.next=24;break}if((s=u.value).evaluationMatchOutcome!==f.a.MATCH){o.next=15;break}t.push(n(s)),o.next=21;break;case 15:if(s.evaluationMatchOutcome!==f.a.POTENTIAL_MATCH){o.next=21;break}return o.next=18,V(s.evaluationResults);case 18:d=o.sent,d.matched&&t.push(n(s));case 21:a=!0,o.next=9;break;case 24:o.next=30;break;case 26:o.prev=26,o.t0=o.catch(7),r=!0,c=o.t0;case 30:o.prev=30,o.prev=31,a||null==i.return||i.return();case 33:if(o.prev=33,!r){o.next=36;break}throw c;case 36:return o.finish(33);case 37:return o.finish(30);case 38:return o.abrupt("return",t);case 39:case"end":return o.stop()}},_callee5,null,[[7,26,30,38],[31,,33,37]])}));return function evaluateRoutingTargetingConditions(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(u.a)(o.a.mark(function _callee6(e){var t,n,a,c,i,u,s,d,l,b,p;return o.a.wrap(function _callee6$(o){for(;;)switch(o.prev=o.next){case 0:if(t=e.evaluationMatchOutcome,n=e.evaluationResults,a=void 0===n?[]:n,c=e.onMatched,i=void 0===c?function(){}:c,u=e.onDidNotMatch,s=void 0===u?function(){}:u,d=[],t!==f.a.MATCH){o.next=4;break}return o.abrupt("return",i());case 4:if(t!==f.a.NO_MATCH){o.next=6;break}return o.abrupt("return",s());case 6:if(t!==f.a.POTENTIAL_MATCH){o.next=17;break}return o.next=9,V(a);case 9:if(l=o.sent,b=l.matched,p=l.asyncConditionListeners,!b){o.next=16;break}return o.abrupt("return",i());case 16:d=[].concat(Object(r.a)(d),Object(r.a)(p));case 17:if(d.forEach(function(e){return P(e,function(){return i()})}),d.length){o.next=20;break}return o.abrupt("return",s());case 20:return o.abrupt("return",s());case 21:case"end":return o.stop()}},_callee6)}));return function evaluateWidgetDisplayTargetingConditions(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(u.a)(o.a.mark(function _callee7(e){var t,n,c,i,u,d,l,b,p,v,O,E,g,m,I,j,_,h,y,C,A,S,T,x,k,R,M,w,L,U,H;return o.a.wrap(function _callee7$(o){for(;;)switch(o.prev=o.next){case 0:E=function _ref17(e){return Object(s.a)(function(e){return e.evaluatedTargetConditionSet},e.filter(function(e){return e.fullyEvaluatedAndMatched})).filter(function(e){return e.fullyEvaluated}).map(function(e){return e.evaluatedTargetCondition}).filter(function(e){return e.matched}).map(function(e){return e.condition})},O=function _ref16(e){var t=e.filter(function(e){return"EVALUATED"===e.status}).map(function(e){return e.targetingConditions}).filter(function(e){return e.filter(function(e){return e.matched})});return Object(s.a)(function(e){return e.map(function(e){return e.evaluatedCondition})},t)},t=e.conditions,n=void 0===t?[]:t,c=e.onMatched,i=void 0===c?function(){}:c,u=e.onDidNotMatch,d=void 0===u?function(){}:u,l={conditionGroups:[]},b=[],p=function onConditionMatched(e){var t=e.campaignId,n=e.matchedConditions,a=(void 0===n?[]:n).map(function(e){return e.field}).filter(function(e){return N.includes(e)}).length>0;return i&&i(t,a),Promise.resolve({TAL:l,matched:!0})},v=function onNoConditionMatched(){return d&&d(),Promise.resolve({TAL:l,matched:!1})},g=!0,m=!1,I=void 0,o.prev=10,j=n.entries()[Symbol.iterator]();case 12:if(g=(_=j.next()).done){o.next=47;break}if(h=Object(a.a)(_.value,2),y=h[0],C=h[1],A=C.campaignId,S=C.evaluationMatchOutcome,T=C.evaluationResults,x=void 0===T?[]:T,S!==f.a.NO_MATCH){o.next=19;break}D({evaluationResults:x,auditLog:l,didMatch:!1,campaignId:A,priority:y+1}),o.next=40;break;case 19:if(S!==f.a.MATCH){o.next=25;break}return D({evaluationResults:x,auditLog:l,didMatch:!0,campaignId:A,priority:y+1}),k=E(x),o.abrupt("return",p({campaignId:A,matchedConditions:k}));case 25:if(S!==f.a.POTENTIAL_MATCH){o.next=40;break}return o.next=28,V(x);case 28:if(R=o.sent,M=R.matched,w=R.asyncConditionListeners,L=R.evalLog,D({auditLog:l,evaluationResults:U=void 0===L?[]:L,didMatch:M,campaignId:A,priority:y+1,isServerGenerated:!1,status:w.length?f.b.PENDING:f.b.EVALUATED}),!M){o.next=39;break}return H=O(U),o.abrupt("return",p({campaignId:A,matchedConditions:H}));case 39:b=[].concat(Object(r.a)(b),Object(r.a)(w));case 40:if(y!==n.length-1){o.next=44;break}if(b.forEach(function(e){return P(e,function(){return B({conditions:n,onMatched:i,onDidNotMatch:d})})}),b.length){o.next=44;break}return o.abrupt("return",v());case 44:g=!0,o.next=12;break;case 47:o.next=53;break;case 49:o.prev=49,o.t0=o.catch(10),m=!0,I=o.t0;case 53:o.prev=53,o.prev=54,g||null==j.return||j.return();case 56:if(o.prev=56,!m){o.next=59;break}throw I;case 59:return o.finish(56);case 60:return o.finish(53);case 61:return o.abrupt("return",v());case 62:case"end":return o.stop()}},_callee7,null,[[10,49,53,61],[54,,56,60]])}));return function evaluateCampaignTargetingConditions(t){return e.apply(this,arguments)}}()},CYoe:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"d",function(){return c}),n.d(t,"a",function(){return i}),n.d(t,"c",function(){return o});var a=n("Cpup"),r=function receiveMarkedTime(e,t){return Object(a.a)({type:"RECEIVE_MARKED_TIME",payload:{name:e,time:t}})},c=function setHasSentImpression(){return Object(a.a)({type:"SET_HAS_SENT_IMPRESSION"})},i=function receiveInitTimestamp(e){return Object(a.a)({type:"RECEIVE_INIT_TIMESTAMP",payload:e})},o=function receiveServerResponseSize(e){return Object(a.a)({type:"RECEIVE_SERVER_RESPONSE_SIZE",payload:e})}},FAmh:function(e,t,n){"use strict";n.d(t,"a",function(){return j}),n.d(t,"d",function(){return _}),n.d(t,"c",function(){return h}),n.d(t,"b",function(){return y});var a=n("nfbA"),r=n("mj2O"),c=n.n(r),i=n("7SM1"),o=n("SHZQ"),u=n("QtlZ"),s=n("vjCh"),d=n("Wjfv"),l=n("La++"),f=n("K7i0"),b=n("SFoa"),p=n("BAMi"),v=n("g6eD"),O=n("i9gz"),E=n("LVcX"),g=n("0lfv"),m=n("ws1h"),I=function(){var e=Object(i.a)(c.a.mark(function _callee(e){var t,n,a,r,i,o,s;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return t=e.forceShow,n=void 0!==t&&t,a=e.targetingResults,r=void 0===a?{}:a,i=u.a.getState().targeting.skipWidgetTargeting,o=function dispatchWidgetTargetingResult(e,t){u.a.dispatch(Object(v.e)({matchedTargeting:t,matchedHours:e}))},c.next=5,Object(m.a)();case 5:if(s=c.sent,!i){c.next=9;break}return o(s,!1),c.abrupt("return");case 9:n?o(!0,!0):Object(p.d)({evaluationMatchOutcome:r.evaluationMatchOutcome,evaluationResults:r.evaluationResults,onMatched:function onMatched(){o(s,!0)},onDidNotMatch:function onDidNotMatch(){return o(s,!1)}});case 10:case"end":return c.stop()}},_callee)}));return function evaluateWidgetTargeting(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(i.a)(c.a.mark(function _callee4(){var e,t,n,r,d,v,E,m,j,h,C,A,S,T,x,k,R,M,w=arguments;return c.a.wrap(function _callee4$(N){for(;;)switch(N.prev=N.next){case 0:if(e=w.length>0&&void 0!==w[0]?w[0]:{},t=e.onDidNotMatch,n=void 0===t?function(){}:t,r=e.unreadCampaignIds,d=void 0===r?[]:r,v=e.evaluatedConditionsResults,E=e.skipCampaignTargeting,m=void 0!==E&&E,j=u.a.getState(),h=j.targeting,C=h.skipCampaigns,A=h.forceShowWidget,S=j.embed.id,T=j.session.campaignRefreshToken,x=function(){var e=Object(i.a)(c.a.mark(function _callee3(e){var t,a,r,o,v;return c.a.wrap(function _callee3$(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,Object(p.c)(e.routingEvaluationResults);case 2:return t=O.sent,a=m||C,u.a.dispatch(Object(f.r)(t)),O.next=7,I({forceShow:A,targetingResults:e.widgetTargetingResults});case 7:if(!a){O.next=9;break}return O.abrupt("return");case 9:return r=function(){var e=Object(i.a)(c.a.mark(function _callee2(e,t){var n;return c.a.wrap(function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:if(!d.includes(e)){a.next=3;break}return a.abrupt("return",Object(s.f)(e));case 3:n=Object(s.d)(e)||{},"BOT"!==n.type?Object(l.a)(e,t):Object(l.b)(e,n.attributes.playbookId,Object(b.a)(),T,t);case 6:case"end":return a.stop()}},_callee2)}));return function onCampaignMatch(t,n){return e.apply(this,arguments)}}(),O.next=12,Object(p.a)({conditions:e.campaignTargetingResults,onMatched:r,onDidNotMatch:n});case 12:return o=O.sent,v=o.TAL,O.next=16,_(v);case 16:case"end":return O.stop()}},_callee3)}));return function evaluateTargetingConditions(t){return e.apply(this,arguments)}}(),N.prev=7,!C||!A){N.next=11;break}return I({forceShow:!0}),N.abrupt("return");case 11:if(v&&!Object(O.a)(v)){N.next=23;break}return k=y(),N.next=15,Object(o.e)(Object(a.a)(Object(a.a)({embedId:S},k),{},{followingCampaignIds:d,excludedCampaignIds:[]}));case 15:if(R=N.sent,M=R.data){N.next=20;break}return Object(g.k)({data:["Empty payload returned for campaign targeting"],type:"warn"}),N.abrupt("return");case 20:x(M),N.next=24;break;case 23:x(v);case 24:N.next=29;break;case 26:N.prev=26,N.t0=N.catch(7),Object(g.e)(new Error("Failed to evaluate campaign targeting - ".concat(N.t0.message)),N.t0);case 29:case"end":return N.stop()}},_callee4,null,[[7,26]])}));return function evalTargetingAndEnrollment(){return e.apply(this,arguments)}}(),_=function(){var e=Object(i.a)(c.a.mark(function _callee5(e){var t,n;return c.a.wrap(function _callee5$(r){for(;;)switch(r.prev=r.next){case 0:if(e&&e.conditionGroups.length){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,Object(o.f)(Object(a.a)(Object(a.a)({},e),h()));case 4:t=r.sent,n=t.data,u.a.dispatch(Object(d.c)({campaignEvalId:n.targetingEvaluationUUID}));case 7:case"end":return r.stop()}},_callee5)}));return function persistTargetingAuditLog(t){return e.apply(this,arguments)}}(),h=function getTargetingEvaluationMetadata(){var e=u.a.getState(),t=e.session,n=e.embed;return{targetingContext:{endUserId:Object(E.a)(void 0,["endUser","id"],t),orgId:n.orgId},evaluationOptions:{ignoreUnknowns:!1}}},y=function getTargetingEvaluationContext(){var e=u.a.getState(),t=e.session,n=t.campaignRefreshToken,a=t.geo,r=t.context,c=t.assignedAgentId,i=Object(O.a)(a)?void 0:a,o=Object(E.a)("",["page","href"],r),s=Object(E.a)({},["conversations","conversations"],e);return{sessionId:n,location:i,pageUrl:o,assignedAgentId:c,hasHadConversations:!Object(O.a)(s),inboxId:Object(E.a)(void 0,["embed","configuration","inboxId"],e)}}},IpSJ:function(e,t,n){"use strict";n.d(t,"b",function(){return b}),n.d(t,"a",function(){return p});var a=n("mj2O"),r=n.n(a),c=n("7SM1"),i=n("SHZQ"),o=n("QtlZ"),u=n("0lfv"),s=n("7oto"),d=n("t8ds"),l=n("BAMi"),f=n("FAmh"),b=function(){var e=Object(c.a)(r.a.mark(function _callee(){var e,t,n,a,c,i,u,l,f,b,p,v,O,E,g,m,I;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return e=o.a.getState(),t=e.embed,n=e.session,r.next=3,Object(s.a)({topic:"get-host-window"});case 3:return a=r.sent,c=a.data,i=void 0===c?{}:c,r.next=8,Object(s.a)({topic:"get-host-cookies"});case 8:return u=r.sent,l=u.data,f=void 0===l?{}:l,r.next=13,Object(s.a)({topic:"get-host-referrer"});case 13:return b=r.sent,p=b.data,v=void 0===p?"":p,r.next=18,Object(s.a)({topic:"get-scrollable-height"});case 18:return O=r.sent,E=O.data,r.next=22,d.a.get("visitCounts");case 22:return g=r.sent,m=g.data,I={_window:i,visitInformation:void 0===m?{}:m,cookies:f,geo:n.geo,embed:t,referrer:v,scrollableHeight:E},r.abrupt("return",Promise.resolve(I));case 27:case"end":return r.stop()}},_callee)}));return function generateTargetingContext(){return e.apply(this,arguments)}}(),p=function(){var e=Object(c.a)(r.a.mark(function _callee2(){var e,t,n,a,c,s,d,b=arguments;return r.a.wrap(function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:return e=b.length>0&&void 0!==b[0]?b[0]:[],t=e.map(function(e){return{key:"".concat(e.outputKey,"-").concat(e.label),priority:e.priority,conditionSets:e.conditionSets}}),n=o.a.getState(),a=n.embed,c=Object(f.b)(),r.prev=4,r.next=7,Object(i.b)(a.id,{clientSideContext:c,conditionGroups:t});case 7:return s=r.sent,d=s.data,r.next=11,Object(l.b)(d);case 11:return r.abrupt("return",r.sent);case 14:r.prev=14,r.t0=r.catch(4),Object(u.k)({data:["Failed to evaluate conditional skill",r.t0]});case 17:case"end":return r.stop()}},_callee2,null,[[4,14]])}));return function evaluateTargetingForConditionalSets(){return e.apply(this,arguments)}}()},K7i0:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"n",function(){return c}),n.d(t,"m",function(){return i}),n.d(t,"p",function(){return o}),n.d(t,"i",function(){return u}),n.d(t,"k",function(){return s}),n.d(t,"c",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"q",function(){return f}),n.d(t,"g",function(){return b}),n.d(t,"h",function(){return p}),n.d(t,"j",function(){return v}),n.d(t,"f",function(){return O}),n.d(t,"l",function(){return E}),n.d(t,"o",function(){return g}),n.d(t,"d",function(){return m}),n.d(t,"s",function(){return I}),n.d(t,"r",function(){return j}),n.d(t,"b",function(){return _});var a=n("Cpup"),r=function clearActiveConversation(){return Object(a.a)({type:"CLEAR_ACTIVE_CONVERSATION"})},c=function setActiveConversation(e){return Object(a.a)({type:"SET_ACTIVE_CONVERSATION",payload:e})},i=function sendMessage(e){return Object(a.a)({type:"SEND_MESSAGE",payload:e})},o=function setHasForcedConversation(){return Object(a.a)({type:"SET_HAS_FORCED_CONVERSATION"})},u=function receiveMessageSent(e){return Object(a.a)({type:"RECEIVE_MESSAGE_SENT",payload:e})},s=function receivePreRenderedMessages(e){return Object(a.a)({type:"RECEIVE_PRE_RENDERED_MESSAGES",payload:e})},d=function receiveAgentMessage(e){return Object(a.a)({type:"RECEIVE_AGENT_MESSAGE",payload:e})},l=function receiveAttachments(e){return Object(a.a)({type:"RECEIVE_ATTACHMENTS",payload:e})},f=function setIsTyping(e){return Object(a.a)({type:"RECEIVE_IS_TYPING",payload:e})},b=function receiveConversation(e){return Object(a.a)({type:"RECEIVE_CONVERSATION",payload:e})},p=function receiveInitialActiveConversation(e){return Object(a.a)({type:"RECEIVE_INITIAL_ACTIVE_CONVERSATION",payload:e})},v=function receiveMessagesForConversation(e){return Object(a.a)({type:"RECEIVE_MESSAGES_FOR_CONVERSATION",payload:e})},O=function receiveBulkConversations(e){return Object(a.a)({type:"RECEIVE_BULK_CONVERSATIONS",payload:e})},E=function receiveReadMessages(e){return Object(a.a)({type:"RECEIVE_READ_MESSAGES",payload:e})},g=function setActiveDriftlink(e){return Object(a.a)({type:"SET_ACTIVE_DRIFTLINK",payload:e})},m=function receiveAgentStatus(e){return Object(a.a)({type:"RECEIVE_AGENT_STATUS",payload:e})},I=function setUnreadMessage(e){return Object(a.a)({type:"SET_UNREAD_MESSAGE",payload:e})},j=function setMatchedConversationRoutingRules(e){return Object(a.a)({type:"RECEIVED_MATCHED_CONVO_ROUTING_RULES",payload:e})},_=function permacloseConversation(e){return Object(a.a)({type:"PERMACLOSE_CONVERSATION",payload:e})}},"La++":function(e,t,n){"use strict";var a,r=n("nfbA"),c=n("mj2O"),i=n.n(c),o=n("7SM1"),u=n("xXFf"),s=n("QtlZ"),d=n("SsZN"),l=n("K7i0"),f=n("SFoa"),b=n("y0Ar"),p=n("g6eD"),v=n("NFvl"),O=n("vYqp"),E=n("hm8b"),g=n("vTYT"),m=n("MFhO"),I=n("PjZB"),j=n("7oto"),_=n("EQxi"),h=n("vjCh");!function(e){e[e.RENDERED=0]="RENDERED",e[e.ENROLLED=1]="ENROLLED"}(a||(a={}));var y=n("9ttK");n.d(t,"a",function(){return M}),n.d(t,"b",function(){return w});var C=["EMAIL_CAPTURE","ANNOUNCEMENT_ONE_TIME"],A=/\{\{[\s\w.'"\\|()]+\}\}/g,S=function generateCampaignFrame(e,t,n){return Object(j.a)({topic:"generate-new-frame",message:{name:e,height:t,width:n,path:"core/".concat(e),alignment:Object(f.i)()}})},T={SLIDER:function SLIDER(){return S(g.b.SLIDER,"100%","400px")},TAKEOVER:function TAKEOVER(){return S(g.b.TAKEOVER,"100%","100%")},WELCOME_MESSAGE:function WELCOME_MESSAGE(){return s.a.dispatch(Object(p.b)({chatOpen:!0}))}},x=function dispatchRenderForEmailCaptureCampaign(){return S(g.b.EMAIL_CAPTURE,"0px","400px")},k=function dispatchRenderForAnnouncementCampaign(e){var t=T[e];t&&t()},R=function(){var e=Object(o.a)(i.a.mark(function _callee(e){var t,n,a,r,c,o,d,l,f;return i.a.wrap(function _callee$(i){for(;;)switch(i.prev=i.next){case 0:if(t=Object(y.a)(e,["message"],""),n=Object(y.a)(e,["automaticSender"],!1),a=Object(y.a)(e,["senderId"],null),!(null!==t.match(A))&&!n){i.next=13;break}return r=s.a.getState(),c=r.session,o=Object(v.a)(["endUser","id"],c),i.next=9,Object(u.c)({campaignId:e.id,senderId:Object(y.a)(e,["senderId"]),endUserId:o});case 9:d=i.sent,l=d.data,t=l.message,a=l.senderId;case 13:return f=Object(_.d)(t),i.abrupt("return",{message:f,senderId:a});case 15:case"end":return i.stop()}},_callee)}));return function resolveAnnouncementMessage(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(o.a)(i.a.mark(function _callee2(e,t){var n,a,c,o,u,s,l;return i.a.wrap(function _callee2$(i){for(;;)switch(i.prev=i.next){case 0:if((n=Object(y.b)(e))&&C.includes(n.type)){i.next=3;break}return i.abrupt("return");case 3:return a=Object(y.a)(n,["displayType"]),c=Object(y.a)(n,["playbookId"]),i.next=7,R(n);case 7:o=i.sent,u=o.message,s=o.senderId,l=Object.assign({},Object(r.a)(Object(r.a)({},n),{},{attributes:Object(r.a)(Object(r.a)({},n.attributes),{},{senderId:s})})),Object(d.p)({id:null,authorId:s,attributes:{playbookId:c,campaignId:e},conversationId:null}),Object(h.a)(l,u),Object(b.a)({playbookId:c,isVirtual:!0,isDelayed:t}),n.type===m.a.EMAIL_CAPTURE?x():k(a);case 15:case"end":return i.stop()}},_callee2)}));return function renderAnnouncementCampaign(t,n){return e.apply(this,arguments)}}(),w=function(){var e=Object(o.a)(i.a.mark(function _callee3(e,t,n,c,o){var p,g,m,j,_,C;return i.a.wrap(function _callee3$(i){for(;;)switch(i.prev=i.next){case 0:return p=Object(f.e)(),i.prev=1,g=Object(y.b)(e),m=Object(v.a)(["attributes","interactionId"],g),i.next=6,Object(u.b)({playbookId:t,campaignId:e,interactionId:m,inboxId:g.inboxId,locale:p});case 6:if(204!==(j=i.sent).status){i.next=10;break}return Object(u.a)(e,n,c,p),i.abrupt("return",a.ENROLLED);case 10:return _=j.data,Object(h.a)(g),C=_.messages.map(function(e){return Object(r.a)(Object(r.a)({},e),{},{contentType:I.c.CHAT})}),Object(b.a)({playbookId:t,isVirtual:!0,isDelayed:o}),Object(d.p)(Object(r.a)(Object(r.a)({},C[0]),{},{id:null,conversationId:null})),s.a.dispatch(Object(l.k)({campaignId:e,messages:C,resumeFlowContext:Object(O.a)(E.a,_.resumeFlowContext)})),i.abrupt("return",a.RENDERED);case 19:return i.prev=19,i.t0=i.catch(1),Object(u.a)(e,n,c,p),i.abrupt("return",a.ENROLLED);case 23:case"end":return i.stop()}},_callee3,null,[[1,19]])}));return function renderBotCampaign(t,n,a,r,c){return e.apply(this,arguments)}}()},OA1u:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"c",function(){return c}),n.d(t,"a",function(){return i}),n.d(t,"d",function(){return o});var a=n("Cpup"),r=function setShouldSkipCampaigns(e){return Object(a.a)({type:"SET_SHOULD_SKIP_CAMPAIGNS",payload:e})},c=function setShouldSkipWidgetTargeting(e){return Object(a.a)({type:"SET_SHOULD_SKIP_WIDGET_TARGETING",payload:e})},i=function setShouldForceShowWidget(e){return Object(a.a)({type:"SET_SHOULD_FORCE_SHOW_WIDGET",payload:e})},o=function updateOnlineStatus(e){return Object(a.a)({type:"UPDATE_ONLINE_STATUS",payload:e})}},PCkZ:function(e,t,n){"use strict";var a=n("nfbA"),r=n("mj2O"),c=n.n(r),i=n("7SM1"),o=n("LqZ+"),u=n("QtlZ"),s=n("z8Kx"),d=n("vYqp"),l=n("hm8b"),f=n("LelF"),b=n("0lfv"),p=n("VYE+"),v=n("F8vJ"),O=n("Cpup"),E=function receiveIdentityMap(e){return Object(O.a)({type:"RECEIVE_IDENTITY_MAP",payload:e})},g=n("qSAj"),m={isEnabled:function isEnabled(){return!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).eloqua_cookie_id_enabled},identify:function(){var e=Object(i.a)(c.a.mark(function _callee2(){var e,t,n,a,r=arguments;return c.a.wrap(function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:if(e=r.length>0&&void 0!==r[0]?r[0]:{},t=r.length>1?r[1]:void 0,n=e[f.g]){o.next=5;break}return o.abrupt("return",null);case 5:return a=function(){var e=Object(i.a)(c.a.mark(function _callee(){var e,a,r;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(g.a)({cookie:n,orgId:u.a.getState().embed.orgId,anonId:t});case 2:if(e=c.sent,a=e.data,(r=void 0===a?{}:a).email){c.next=7;break}return c.abrupt("return",null);case 7:return c.abrupt("return",{eloquaCookie:n,email:r.email});case 8:case"end":return c.stop()}},_callee)}));return function _identifyEloquaUser(){return e.apply(this,arguments)}}(),o.prev=6,o.next=9,a();case 9:return o.abrupt("return",o.sent);case 12:return o.prev=12,o.t0=o.catch(6),Object(b.q)(["Failed to identify eloqua user",o.t0]),o.abrupt("return",null);case 16:case"end":return o.stop()}},_callee2,null,[[6,12]])}));return function identify(){return e.apply(this,arguments)}}()},I=n("LVcX"),j={isEnabled:function isEnabled(){return!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).hubspot_js},identify:function(){var e=Object(i.a)(c.a.mark(function _callee3(e){return c.a.wrap(function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:if(window._hsq){t.next=3;break}return t.abrupt("return",null);case 3:window._hsq.push(function(){var t=Object(i.a)(c.a.mark(function _callee2(t){var n,a;return c.a.wrap(function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:if(t){r.next=2;break}return r.abrupt("return",null);case 2:if(n=Object(I.a)(null,["visitor","utk"],t)){r.next=5;break}return r.abrupt("return",null);case 5:return a=function(){var t=Object(i.a)(c.a.mark(function _callee(){var t,a,r;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(g.b)({utk:n,orgId:u.a.getState().embed.orgId,anonId:e});case 2:if(t=c.sent,a=t.data,(r=void 0===a?{}:a).email){c.next=7;break}return c.abrupt("return",null);case 7:return c.abrupt("return",{email:r.email});case 8:case"end":return c.stop()}},_callee)}));return function _identifyHubspotUser(){return t.apply(this,arguments)}}(),r.prev=6,r.next=9,a();case 9:return r.abrupt("return",r.sent);case 12:r.prev=12,r.t0=r.catch(6),Object(b.q)(["Failed to identify hubspot user",r.t0]);case 15:case"end":return r.stop()}},_callee2,null,[[6,12]])}));return function(e){return t.apply(this,arguments)}}());case 4:case"end":return t.stop()}},_callee3)}));return function identify(t){return e.apply(this,arguments)}}()},_={isEnabled:function isEnabled(){return!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).marketo},identify:function(){var e=Object(i.a)(c.a.mark(function _callee2(){var e,t,n,a,r=arguments;return c.a.wrap(function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:if(e=r.length>0&&void 0!==r[0]?r[0]:{},t=r.length>1?r[1]:void 0,n=e[f.h]){o.next=5;break}return o.abrupt("return",null);case 5:return a=function(){var e=Object(i.a)(c.a.mark(function _callee(){var e,a,r;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(g.c)({munchkin:n,orgId:u.a.getState().embed.orgId,anonId:t});case 2:return e=c.sent,a=e.data,r=void 0===a?{}:a,c.abrupt("return",{email:r.email,munchkinCookie:n});case 6:case"end":return c.stop()}},_callee)}));return function _identifyMarketoUser(){return e.apply(this,arguments)}}(),o.prev=6,o.next=9,a();case 9:return o.abrupt("return",o.sent);case 12:o.prev=12,o.t0=o.catch(6),Object(b.q)(["Failed to identify marketo user",o.t0]);case 15:case"end":return o.stop()}},_callee2,null,[[6,12]])}));return function identify(){return e.apply(this,arguments)}}()},h=n("JBtm"),y=n.n(h),C={identify:function identify(){var e=Object(I.a)(null,["session","context","page","search"],u.a.getState());if(!e)return null;var t=y.a.parse(e);return t.d_utk?t.d_utk:null}},A={isEnabled:function isEnabled(){return!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).pardot_cookie_id_enabled},identify:function(){var e=Object(i.a)(c.a.mark(function _callee2(){var e,t,n,a,r=arguments;return c.a.wrap(function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:if(e=r.length>0&&void 0!==r[0]?r[0]:{},t=r.length>1?r[1]:void 0,n=e[f.i]){o.next=5;break}return o.abrupt("return",null);case 5:return a=function(){var e=Object(i.a)(c.a.mark(function _callee(){var e,a,r;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(g.d)({cookie:n,orgId:u.a.getState().embed.orgId,anonId:t});case 2:return e=c.sent,a=e.data,r=void 0===a?{}:a,c.abrupt("return",{email:r.email,pardotCookie:n});case 6:case"end":return c.stop()}},_callee)}));return function _identifyPardotUser(){return e.apply(this,arguments)}}(),o.prev=6,o.next=9,a();case 9:return o.abrupt("return",o.sent);case 12:o.prev=12,o.t0=o.catch(6),Object(b.q)(["Failed to identify pardot user",o.t0]);case 15:case"end":return o.stop()}},_callee2,null,[[6,12]])}));return function identify(){return e.apply(this,arguments)}}()};n.d(t,"b",function(){return S}),n.d(t,"a",function(){return T}),n.d(t,"c",function(){return x});var S=function getIntegrationIdentityContext(){var e=u.a.getState().identity,t=e.marketo_cookie,n=e.pardot_cookie,a=e.eloqua_cookie,r={};return t&&(r.marketo={munchkinValue:t}),n&&(r.pardot={visitorId:n}),a&&(r.eloqua={cookie:a}),r},T=function(){var e=Object(i.a)(c.a.mark(function _callee(){var e,t,n,a,r,i;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return e=Object(s.b)(),c.next=3,Object(s.e)();case 3:if(t=c.sent,n=t.externalId,a=t.userJwt,!(!!n||!!a)){c.next=13;break}return c.next=10,D({id:n,email:e,userJwt:a});case 10:c.t0=c.sent,c.next=16;break;case 13:return c.next=15,k(e);case 15:c.t0=c.sent;case 16:return r=c.t0,i=Object(d.a)(l.a,r),u.a.dispatch(E(i)),c.abrupt("return",r);case 20:case"end":return c.stop()}},_callee)}));return function generateIdentity(){return e.apply(this,arguments)}}(),x=function(){var e=Object(i.a)(c.a.mark(function _callee2(e,t,n){var r,i,u;return c.a.wrap(function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:if(c.prev=0,!t||V(t)){c.next=4;break}return Object(b.k)({data:["Unable to identify due to undefined userId"]}),c.abrupt("return");case 4:if(r=Object(a.a)({},n),!t||r.userJwt){c.next=11;break}return c.next=8,Object(s.e)();case 8:i=c.sent,(u=i.userJwt)&&(r.userJwt=u);case 11:return c.next=13,Object(o.b)(e,t,r);case 13:c.next=18;break;case 15:c.prev=15,c.t0=c.catch(0),Object(b.k)({data:[c.t0],type:"warn"});case 18:case"end":return c.stop()}},_callee2,null,[[0,15]])}));return function updateIdentity(t,n,a){return e.apply(this,arguments)}}(),k=function(){var e=Object(i.a)(c.a.mark(function _callee3(e){var t;return c.a.wrap(function _callee3$(n){for(;;)switch(n.prev=n.next){case 0:return t={},n.next=3,N();case 3:return t.lead_id=n.sent,n.t0=Object,n.t1=t,n.next=8,R(t,e);case 8:return n.t2=n.sent,t=n.t0.assign.call(n.t0,n.t1,n.t2),n.t3=Object,n.t4=t,n.next=14,w(t);case 14:return n.t5=n.sent,t=n.t3.assign.call(n.t3,n.t4,n.t5),n.abrupt("return",t);case 17:case"end":return n.stop()}},_callee3)}));return function resolveIdentityProviders(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(i.a)(c.a.mark(function _callee4(e,t){return c.a.wrap(function _callee4$(n){for(;;)switch(n.prev=n.next){case 0:return Object(v.a)(t)&&(e.email=t),M(e),n.abrupt("return",e);case 3:case"end":return n.stop()}},_callee4)}));return function resolveDirectIdentityProviders(t,n){return e.apply(this,arguments)}}(),M=function resolveOneShotIdentity(e){var t=C.identify();t&&(e.oneshot_token=t)},w=function(){var e=Object(i.a)(c.a.mark(function _callee5(e){var t,n,a,r,i,o,s,d,l;return c.a.wrap(function _callee5$(c){for(;;)switch(c.prev=c.next){case 0:return t=u.a.getState(),n=t.embed.configuration.gates,a=void 0===n?{}:n,c.next=4,Object(p.c)();case 4:if(r=c.sent,i=e.lead_id,!j.isEnabled(a)){c.next=11;break}return c.next=9,j.identify(i);case 9:(o=c.sent)&&(e.email=o.email);case 11:if(!_.isEnabled(a)){c.next=16;break}return c.next=14,_.identify(r,i);case 14:(s=c.sent)&&(e.marketo_cookie=s.munchkinCookie,s.email&&(e.email=s.email));case 16:if(!A.isEnabled(a)){c.next=21;break}return c.next=19,A.identify(r,i);case 19:(d=c.sent)&&(e.pardot_cookie=d.pardotCookie,d.email&&(e.email=d.email));case 21:if(!m.isEnabled(a)){c.next=26;break}return c.next=24,m.identify(r,i);case 24:(l=c.sent)&&(e.eloqua_cookie=l.eloquaCookie,l.email&&(e.email=l.email));case 26:return c.abrupt("return",e);case 27:case"end":return c.stop()}},_callee5)}));return function resolveThirdPartyIdentityProviders(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(i.a)(c.a.mark(function _callee6(){var e,t,n;return c.a.wrap(function _callee6$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(p.e)(f.a);case 2:return e=a.sent,a.next=5,Object(p.e)(f.b);case 5:if(t=a.sent,e){a.next=14;break}if(!t){a.next=10;break}return Object(p.h)(f.a,t),a.abrupt("return",t);case 10:return n=Object(b.p)(),Object(p.h)(f.a,n),Object(p.h)(f.b,n),a.abrupt("return",n);case 14:return a.abrupt("return",e);case 15:case"end":return a.stop()}},_callee6)}));return function generateAnonymousIdentity(){return e.apply(this,arguments)}}(),D=function(){var e=Object(i.a)(c.a.mark(function _callee7(e){var t,n,a,r,i,o;return c.a.wrap(function _callee7$(c){for(;;)switch(c.prev=c.next){case 0:if(t=e.id,n=e.email,a=e.userJwt,r={user_id:t},n&&(r.email=n),a&&(r.jwt=a),i=Object(s.c)()&&!a,o=!V(t),M(r),!i&&!o){c.next=13;break}return delete r.user_id,delete r.jwt,c.next=12,N();case 12:r.lead_id=c.sent;case 13:return c.abrupt("return",r);case 14:case"end":return c.stop()}},_callee7)}));return function generateExternalIdMap(t){return e.apply(this,arguments)}}(),V=function isValidExternalId(e){return!!e&&(!("undefined"===e)&&!("undefined-undefined"===e)&&!("d41d8cd98f00b204e9800998ecf8427e"===e))}},SFoa:function(e,t,n){"use strict";n.d(t,"f",function(){return l}),n.d(t,"c",function(){return f}),n.d(t,"d",function(){return b}),n.d(t,"b",function(){return p}),n.d(t,"i",function(){return v}),n.d(t,"g",function(){return O}),n.d(t,"a",function(){return g}),n.d(t,"e",function(){return m}),n.d(t,"h",function(){return I});var a=n("QtlZ"),r=n("da4L"),c=n("LVcX"),i=n("BCC6"),o=n("YsSj"),u=n("yzXs"),s=n("9A2/"),d=n("vTYT"),l=function getEmbedThemeProperty(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Object(c.a)(n,["configuration","theme",t],e)},f=function getCampaignIdFromInteractionId(e){var t=Object(c.a)(null,["embed","configuration","campaigns"],a.a.getState());if(t){var n=Object(i.a)(Object(o.a)(function hasInteractionId(t){return Object(r.a)(t,"interactionId")===e},t));if(n)return n.id}return null},b=function getCampaignPropertyById(e,t){var n=p(e);return n?Object(c.a)(null,[t],n):null},p=function getCampaignFromEmbedById(e){return Object(c.a)([],["embed","configuration","campaigns"],a.a.getState()).filter(function(t){return t.id===e})[0]},v=function getWidgetAlignment(){return Object(c.a)(d.a.RIGHT,["embed","configuration","theme","alignment"],a.a.getState())},O=function getOrgId(){return Object(c.a)(0,["embed","orgId"],a.a.getState())},E=Object(u.a)(Object(c.a)(void 0,["id"]),Object(s.a)(function(e){return e.bot}),Object(c.a)(void 0,["embed","configuration","team"])),g=function getBotSenderId(){return E(a.a.getState())},m=function getEmbedLocale(){return Object(c.a)("en",["embed","configuration","locale"],a.a.getState())},I=function getUseWidgetLocaleForGDPR(){return Object(c.a)(!1,["embed","configuration","dataProtection","targetBasedOnWidgetLocale"],a.a.getState())}},SsZN:function(e,t,n){"use strict";n.d(t,"b",function(){return v}),n.d(t,"e",function(){return O}),n.d(t,"h",function(){return E}),n.d(t,"i",function(){return g}),n.d(t,"j",function(){return m}),n.d(t,"l",function(){return I}),n.d(t,"k",function(){return j}),n.d(t,"m",function(){return _}),n.d(t,"n",function(){return h}),n.d(t,"f",function(){return y}),n.d(t,"o",function(){return C}),n.d(t,"q",function(){return A}),n.d(t,"c",function(){return S}),n.d(t,"p",function(){return T}),n.d(t,"g",function(){return x}),n.d(t,"s",function(){return k}),n.d(t,"a",function(){return R}),n.d(t,"d",function(){return M}),n.d(t,"r",function(){return w});var a=n("mj2O"),r=n.n(a),c=n("7SM1"),i=n("nfbA"),o=n("QtlZ"),u=n("LVcX"),s=n("SWQ0"),d=n("6lNa"),l=n("0lfv"),f=n("wNJw"),b=function hydrateWithActiveCampaignData(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=o.a.getState().campaigns,n=void 0===t?{}:t;if(e&&e.conversationId){var a=Object(u.a)(null,["activeCampaign","message","conversationId"],n);if(e.conversationId!==a)return e}var r=Object(u.a)(null,["activeCampaign","attributes","campaignId"],n),c=Object(u.a)(null,["activeCampaign","attributes","startInteraction"],n),s=Object(u.a)(null,["activeCampaign","attributes","playbookId"],n);return Object(i.a)(Object(i.a)({},e),{},{campaignId:r,interactionId:c,playbookId:s})},p=function createMessageEventPayload(e){return b({inboxId:e.inboxId,conversationId:e.conversationId})},v=function triggerButtonClickedAPIEvent(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(u.a)(null,["attributes","questionId"],e),n=b({createdAt:e.createdAt,authorId:e.authorId,conversationId:e.conversationId,buttonBody:e.body,questionId:t});Object(f.a)(s.b.CONVERSATION_BUTTON_CLICKED,n)},O=function triggerConversationFirstInteractionAPIEvent(e){var t=b({createdAt:e.createdAt,authorId:e.authorId});Object(f.a)(s.b.CONVERSATION_INTERACTED,t)},E=function triggerEmailCapturedAPIEvent(e){var t=e.email,n=o.a.getState().conversations,a=(void 0===n?{}:n).activeConversation||null,r={data:b({email:t,conversationId:a})};Object(f.a)(s.b.EMAIL_CAPTURED,r)},g=function triggerMeetingRequestedAPIEvent(e){var t=Object(u.a)([],["embed","configuration","team"],o.a.getState()).filter(function(t){return t.id===e});if(t.length){var n=t[0],a={teamMember:{id:n.id,name:n.name}};Object(f.a)(s.b.MEETING_REQUESTED,a)}},m=function triggerMeetingScheduledAPIEvent(e){var t=e.agentId,n=e.meetingTime,a=e.duration,r=e.timeZone,c=e.conversationId,i=Object(u.a)({},["conversations","messages",c],o.a.getState()),d=i[Object.keys(i)[0]],l=Object(u.a)([],["embed","configuration","team"],o.a.getState()).filter(function(e){return e.id===t})[0];if(d){var b=Object(u.a)(null,["attributes","campaignId"],d),p=Object(u.a)(null,["attributes","playbookId"],d),v=Object(u.a)(null,["attributes","startInteraction"],d),O={teamMember:{id:l.id,name:l.name},meeting:{time:n,duration:a,timeZone:r},conversationId:c,playbookId:p,campaignId:b,interactionId:v};Object(f.a)(s.b.MEETING_BOOKED,O)}},I=function triggerMessageSentAPIEvent(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(f.a)(s.b.MESSAGE_SENT,p(e))},j=function triggerMessageReceivedAPIEvent(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function getTeamUser(e){return e?Object(u.a)([],["embed","configuration","team"],o.a.getState()).find(function(t){return t.id===e}):null}(e.authorId)||{},n=Object(i.a)(Object(i.a)({},p(e)),{},{teamMember:{id:t.id,name:t.name}});Object(f.a)(s.b.MESSAGE_RECEIVED,n)},_=function triggerPhoneCapturedAPIEvent(e,t){var n=b({createdAt:e.createdAt,authorId:e.authorId,conversationId:e.conversationId,phone:t});Object(f.a)(s.b.PHONE_NUMBER_CAPTURED,n)},h=function triggerPlaybookClickedAPIEvent(e){var t=(e||{}).conversationId,n=b({conversationId:t});Object(f.a)(s.b.CONVERSATION_PLAYBOOK_CLICKED,n)},y=function triggerConversationSelectedAPIEvent(e){var t=b({conversationId:e});Object(f.a)(s.b.CONVERSATION_SELECTED,t)},C=function triggerPlaybookDismissedAPIEvent(e){var t=e||{},n=t.conversationId,a=t.id,r=b({conversationId:n,messageId:a});Object(f.a)(s.b.CONVERSATION_PLAYBOOK_DISMISSED,r)},A=function(){var e=Object(c.a)(r.a.mark(function _callee(e){var t;return r.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:t=Object(i.a)({botMessage:Object(l.g)(e)},b()),Object(f.a)(s.b.SLIDER_CLOSED,t);case 2:case"end":return n.stop()}},_callee)}));return function triggerSliderClosedAPIEvent(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(c.a)(r.a.mark(function _callee2(e,t){var n,a,c;return r.a.wrap(function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:if(e&&t){r.next=2;break}return r.abrupt("return");case 2:n=Object(u.a)(!1,["view","matchedTargeting"],o.a.getState()),a=Object(u.a)(!1,["targeting","isOnline"],o.a.getState()),c={campaignId:t,data:{isOnline:a,sidebarOpen:!1,widgetVisible:n}},r.t0=e,r.next=r.t0===d.b.CLICKED?8:r.t0===d.b.SUBMITTED?10:r.t0===d.b.OPENED?12:r.t0===d.b.DISMISSED?14:16;break;case 8:return Object(f.a)(s.b.CAMPAIGN_CLICKED,c),r.abrupt("break",17);case 10:return Object(f.a)(s.b.CAMPAIGN_SUBMITTED,c),r.abrupt("break",17);case 12:return Object(f.a)(s.b.CAMPAIGN_OPENED,c),r.abrupt("break",17);case 14:return Object(f.a)(s.b.CAMPAIGN_DISMISSED,c),r.abrupt("break",17);case 16:return r.abrupt("break",17);case 17:case"end":return r.stop()}},_callee2)}));return function triggerCampaignActionAPIEvent(t,n){return e.apply(this,arguments)}}(),T=function triggerPlaybookFiredAPIEvent(e){var t=e||{},n=t.authorId,a=t.conversationId,r=t.createdAt,c=t.id,i=t.attributes,o=(i=void 0===i?{playbookId:null,startInteraction:null,interactionId:null,campaignId:null}:i).playbookId,u=i.startInteraction,d=i.interactionId,l=i.campaignId;Object(f.a)(s.b.CONVERSATION_PLAYBOOK_FIRED,{messageId:c,createdAt:r,authorId:n,conversationId:a,interactionId:d||u,playbookId:o,campaignId:l})},x=function triggerConversationStartedAPIEvent(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={inboxId:e.inboxId,conversationId:e.conversationId};Object(f.a)(s.b.CONVERSATION_STARTED,t)},k=function triggerWelcomeMessageAPIEvent(e){var t=e?s.b.WELCOME_MESSAGE_OPENED:s.b.WELCOME_MESSAGE_CLOSED;Object(f.a)(t)},R=function triggerAwayMessageAPIEvent(e){var t=e?s.b.AWAY_MESSAGE_OPENED:s.b.AWAY_MESSAGE_CLOSED;Object(f.a)(t)},M=function createTriggerChatVisibleAPIEvent(){var e=!1;return function(t){e!==(t=!!t)&&((t?[s.b.CHAT_OPENED,s.b.SIDEBAR_OPENED]:[s.b.CHAT_CLOSED,s.b.SIDEBAR_CLOSED]).forEach(function(e){return Object(f.a)(e)}),e=t)}}(),w=function triggerUserAttributesUpdatedEvent(){Object(f.a)(s.b.USER_ATTRIBUTES_UPDATED)}},TDUE:function(e,t,n){"use strict";var a=n("jm9a"),r=n("nfbA"),c=n("mj2O"),i=n.n(c),o=n("7SM1"),u=n("SHZQ"),s=n("hm8b"),d=n("mfas"),l=n("MFhO"),f=n("gG69"),b=n("t8ds"),p=n("QtlZ"),v=n("9ttK"),O=n("CYoe"),E=n("LVcX"),g=n("0lfv"),m=function getTimeToImpression(e){if(e&&!function hasSentImpression(){var e=p.a.getState().impressions;return(void 0===e?{}:e).hasSentImpression||!1}())return p.a.dispatch(Object(O.d)()),Date.now()-e},I=function(){var e=Object(o.a)(i.a.mark(function _callee(e){var t,n,a,r,c,o,u,d,l,f,b,O,I,h,y,C,A,S,T,x,k,R,M,w,N,D,V,L,P,U,H,G;return i.a.wrap(function _callee$(i){for(;;)switch(i.prev=i.next){case 0:if(t=e.source,n=e.meta,a=void 0===n?{}:n,r=p.a.getState(),c=r.embed,o=void 0===c?{}:c,u=r.session,d=void 0===u?{}:u,l=r.conversations,f=void 0===l?{}:l,b=r.campaigns,O=void 0===b?{}:b,I=r.metrics,h=void 0===I?{}:I,i.prev=2,y=o.orgId,C=Object(E.a)(null,["endUser","id"],d),A=Object(E.a)(null,["activeCampaign","id"],O),S=a.conversationId||f.activeConversation,T=d.id,x=d.instanceId,k=Date.now(),R=Object(E.a)("",["context","page","url"],d),M=Object(E.a)("",["geo","country"],d),w=Object(E.a)("",["context","userAgent"],d),N=Object(s.a)(a.playbookId)?void 0:a.playbookId,D=Object(s.a)(a.interactionId)?void 0:a.interactionId,V=a.virtual||!1,L=a.isDelayed||!1,!j(t)){i.next=23;break}return U=Object(v.b)(A),H=Object(v.a)(U,["campaignReenrollmentType"],null),i.next=22,_(N,C,T,x,S,H,V);case 22:P=i.sent;case 23:return G=m(h.initTimestamp),i.abrupt("return",{orgId:y,endUserId:C,sessionId:T,sentAt:k,impressionSource:{source:t,playbookId:N,interactionId:D,instanceId:x,virtual:V,widgetVersion:2,sendId:P,timeToImpression:G,delayed:L},context:{url:R,userAgent:w,country:M}});case 27:return i.prev=27,i.t0=i.catch(2),Object(g.e)(new Error("Failed to create impression event: ".concat(i.t0.message))),i.abrupt("return",null);case 31:case"end":return i.stop()}},_callee,null,[[2,27]])}));return function createImpressionEvent(t){return e.apply(this,arguments)}}();n.d(t,"b",function(){return j}),n.d(t,"a",function(){return _}),n.d(t,"d",function(){return h}),n.d(t,"c",function(){return C});var j=function isPlaybookImpressionEvent(e){return e===f.c.ACTIVE_PLAYBOOK||e===f.c.PASSIVE_PLAYBOOK},_=function(){var e=Object(o.a)(i.a.mark(function _callee(e,t,n,a,r,c,o){var u,s;return i.a.wrap(function _callee$(i){for(;;)switch(i.prev=i.next){case 0:if(o){i.next=2;break}return i.abrupt("return",r?"CONVERSATION:".concat(r):void 0);case 2:if(t&&e&&n){i.next=4;break}return i.abrupt("return",u);case 4:i.t0=c,i.next=i.t0===l.b.ONCE?7:i.t0===l.b.ONCE_PER_SESSION?9:i.t0===l.b.ALWAYS?11:19;break;case 7:return u="ONCE:".concat(t,":").concat(e),i.abrupt("break",19);case 9:return u="ONCE_PER_SESSION:".concat(t,":").concat(e,":").concat(n),i.abrupt("break",19);case 11:return i.next=13,A(e);case 13:if(!(s=i.sent)){i.next=16;break}return i.abrupt("return",s);case 16:return u="ALWAYS:".concat(t,":").concat(e,":").concat(a),y(e,u),i.abrupt("break",19);case 19:return i.abrupt("return",u);case 20:case"end":return i.stop()}},_callee)}));return function getImpressionSendId(t,n,a,r,c,i,o){return e.apply(this,arguments)}}(),h=function(){var e=Object(o.a)(i.a.mark(function _callee2(e){var t,n,a=arguments;return i.a.wrap(function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:return t=a.length>1&&void 0!==a[1]?a[1]:{},r.next=3,I({source:e,meta:t});case 3:if(!(n=r.sent)){r.next=7;break}return Object(u.g)(n),r.abrupt("return",!0);case 7:return r.abrupt("return",!1);case 8:case"end":return r.stop()}},_callee2)}));return function trackWidgetImpression(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(o.a)(i.a.mark(function _callee3(e,t){var n,c,o;return i.a.wrap(function _callee3$(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,b.b.get("ALWAYS_SEND_IDS");case 2:return n=i.sent,c=n.data,o=void 0===c?{}:c,i.next=7,b.b.set("ALWAYS_SEND_IDS",Object(r.a)(Object(r.a)({},o),{},Object(a.a)({},e,t)));case 7:case"end":return i.stop()}},_callee3)}));return function addSendIdToStore(t,n){return e.apply(this,arguments)}}(),C=function(){var e=Object(o.a)(i.a.mark(function _callee4(e){var t,n,a;return i.a.wrap(function _callee4$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,b.b.get("ALWAYS_SEND_IDS");case 2:return t=r.sent,n=t.data,a=Object(s.a)(n)?{}:Object(d.a)(["".concat(e)],n),r.next=7,b.b.set("ALWAYS_SEND_IDS",a);case 7:case"end":return r.stop()}},_callee4)}));return function removeSendIdFromStore(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(o.a)(i.a.mark(function _callee5(e){var t,n;return i.a.wrap(function _callee5$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,b.b.get("ALWAYS_SEND_IDS");case 2:return t=a.sent,n=t.data,a.abrupt("return",Object(s.a)(n)?null:n[e]);case 5:case"end":return a.stop()}},_callee5)}));return function getSendIdInStore(t){return e.apply(this,arguments)}}()},Wjfv:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return i}),n.d(t,"d",function(){return o}),n.d(t,"e",function(){return u});var a=n("Cpup"),r=function receiveActiveCampaign(e){return Object(a.a)({type:"RECEIVE_ACTIVE_CAMPAIGN",payload:e})},c=function clearActiveCampaign(){return Object(a.a)({type:"CLEAR_ACTIVE_CAMPAIGN"})},i=function receiveCampaignEvalId(e){return Object(a.a)({type:"RECEIVE_CAMPAIGN_EVAL_ID",payload:e})},o=function receiveIneligibleCampaigns(e){return Object(a.a)({type:"RECEIVE_INELIGIBLE_CAMPAIGNS",payload:e})},u=function receiveUnreadCampaigns(e){return Object(a.a)({type:"RECEIVE_UNREAD_CAMPAIGNS",payload:e})}},"X9/c":function(e,t,n){"use strict";n.d(t,"c",function(){return u}),n.d(t,"a",function(){return d}),n.d(t,"d",function(){return l}),n.d(t,"b",function(){return f});var a=n("mj2O"),r=n.n(a),c=n("7SM1"),i=n("7oh4"),o=n("7oto"),u=function setControllerDimensions(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(o.a)({topic:"set-frame-dimensions",message:{height:"".concat(e,"px"),name:"controller",width:"".concat(t,"px")}})},s=function setControllerHeight(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(o.a)({topic:"set-frame-height",message:{height:"".concat(e,"px"),name:"controller",max:!1}})},d=function(){var e=Object(c.a)(r.a.mark(function _callee(){var e;return r.a.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(o.a)({topic:"get-frame-height",message:{name:"controller"}});case 2:if(e=t.sent,"0px"!==e.data){t.next=6;break}return t.abrupt("return");case 6:s(0);case 7:case"end":return t.stop()}},_callee)}));return function hideWidgetController(){return e.apply(this,arguments)}}(),l=function(){var e=Object(c.a)(r.a.mark(function _callee2(){var e;return r.a.wrap(function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(o.a)({topic:"get-frame-height",message:{name:"controller"}});case 2:if(e=t.sent,"0px"===e.data){t.next=6;break}return t.abrupt("return");case 6:s(i.a);case 7:case"end":return t.stop()}},_callee2)}));return function showWidgetController(){return e.apply(this,arguments)}}(),f=function resetControllerSize(){s(i.a),function setControllerWidth(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(o.a)({topic:"set-frame-width",message:{width:"".concat(e,"px"),name:"controller"}})}(i.b)}},YA8z:function(e,t,n){"use strict";var a=n("X9/c"),r=n("U3QC"),c=n("icD7"),i=n("Cpup"),o={id:null,attributes:{},message:null},u={activeCampaign:o,campaignEvalId:null,ineligibleCampaignIds:[],unreadCampaigns:[]},s={RECEIVE_ACTIVE_CAMPAIGN:function receiveActiveCampaignHandler(e){var t=e.action;e.draft.activeCampaign=t.payload.data},CLEAR_ACTIVE_CAMPAIGN:function clearActiveCampaignHandler(e){e.draft.activeCampaign=o},RECEIVE_CAMPAIGN_EVAL_ID:function receiveCampaignEvalIdHandler(e){var t=e.action;e.draft.campaignEvalId=t.payload.campaignEvalId},RECEIVE_UNREAD_CAMPAIGNS:function receiveUnreadCampaignsHandler(e){var t=e.action;e.draft.unreadCampaigns=t.payload},RECEIVE_INELIGIBLE_CAMPAIGNS:function receiveIneligibleCampaignsHandler(e){var t=e.action;e.draft.ineligibleCampaignIds=t.payload}},d=Object(i.b)(u,s),l=n("mj2O"),f=n.n(l),b=n("nfbA"),p=n("7SM1"),v=n("OE2q"),O=n("QtlZ"),E=n("SsZN"),g=n("SFoa"),m=n("PCkZ"),I=n("mssF"),j=n("+/Je"),_=n("bYXQ"),h=n("LVcX"),y=n("DboL"),C=function sendMessage(e){var t=O.a.getState().conversations,n=void 0===t?{}:t,a=Object(h.a)(j.a,["activeConversation"],n);return Object(_.c)(a)?A(e):Object(_.b)(e.conversationId)?T(e):S(e)},A=function sendMessageForPreRenderedConversation(e){var t=O.a.getState().conversations,n=void 0===t?{}:t,a=Object(h.a)([],["messages",j.b],n),r=Object(y.a)(a).slice(0,-1);return Object(I.c)(r,e).then(function(e){return x(e.data,!1),e})},S=function sendMessageForExistingConversation(e){return Object(I.a)(e).then(function(e){return x(e.data,!1),e})},T=function sendMessageForNewConversation(e){return Object(I.b)(e).then(function(e){return x(e.data,!0),e})},x=function onMessageSent(e,t){t||Object(E.g)(e),Object(E.l)(e)},k=n("aO/P"),R=n("LeE/"),M=n("z5yO"),w=n("0lfv"),N=n("K7i0"),D=n("jm9a"),V=n("da4L"),L=n("hm8b"),P=n("i9gz"),U=n("O0zU"),H=n("PjZB"),G=n("9xv8"),F=function mergeConversationStatus(e,t,n){e.conversationStatus[t]=Object(b.a)(Object(b.a)({},e.conversationStatus[t]),n)},B=function updateLastMessage(e,t){if(e.conversations[t.conversationId]){var n=e.conversations[t.conversationId].lastMessage;(!n||Object(V.b)(t)>=Object(V.b)(n))&&(e.conversations[t.conversationId].lastMessage=t)}},W={SEND_MESSAGE:function sendMessageHandler(e){var t=e.action,n=e.draft,a=t.payload.message.conversationId;0===a&&(a=j.b),Object(L.a)(a)&&(a=j.a),n.activeConversation=a,n.chatOpen=!0,n.messages[a]=Object(b.a)(Object(b.a)({},n.messages[a]||{}),{},Object(D.a)({},t.payload.message.attributes.widgetGuid,t.payload.message)),n.conversations[a]||(n.conversations[a]={conversation:{id:a}}),B(n,t.payload.message)},RECEIVE_MESSAGE_SENT:function receiveMessageSentHandler(e){var t=e.action,n=e.draft,a=t.payload,r=a.message,c=a.isNew,i=void 0!==c&&c,o=a.isPreRendered,u=void 0!==o&&o;if(i){var s=u?j.b:j.a;n.messages[r.conversationId]=Object(b.a)(Object(b.a)({},n.messages[s]),{},Object(D.a)({},r.attributes.widgetGuid,r)),n.conversations[r.conversationId]=Object(b.a)(Object(b.a)({},n.conversations[s]),{},{conversation:Object(b.a)(Object(b.a)({},n.conversations[s].conversation),{},{id:r.conversationId})}),delete n.conversations[s],delete n.messages[s]}n.endUserEngaged=!0,i&&!u||Object(P.a)(r.body)||F(n,r.conversationId,{endUserResponded:!0}),n.messages[r.conversationId]=Object(b.a)(Object(b.a)({},n.messages[r.conversationId]),{},Object(D.a)({},r.attributes.widgetGuid,r)),n.activeConversation=r.conversationId,n.conversations[r.conversationId]||(n.conversations[r.conversationId]={conversation:{id:r.conversationId}}),B(n,r)},RECEIVE_PRE_RENDERED_MESSAGES:function receivePreRenderedMessagesHandler(e){var t=e.action,n=e.draft,a=t.payload,r=a.messages,c=a.resumeFlowContext;if(r&&r.length){var i=r.map(function(e,t){return Object(b.a)(Object(b.a)({},e),{},{id:t})});n.messages[j.b]=i,n.unreadAgentMessages[j.b]=i.map(function(e){return e.id}),n.resumeFlowContext=c,n.activeConversation=j.b}},RECEIVE_AGENT_MESSAGE:function receiveAgentMessageHandler(e){var t=e.action,n=e.draft,a=t.payload.message;n.messages[a.conversationId]=Object(b.a)(Object(b.a)({},n.messages[a.conversationId]),{},Object(D.a)({},a.id,a)),n.activeConversation!==a.conversationId&&(n.activeConversation=a.conversationId),B(n,a)},RECEIVE_CONVERSATION:function receiveConversationHandler(e){var t=e.action,n=e.draft,a=t.payload.conversation;n.conversations[a.conversation.id]=a},RECEIVE_INITIAL_ACTIVE_CONVERSATION:function receiveInitialActiveConversationHandler(e){var t=e.action,n=e.draft;n.activeConversation=t.payload.conversation.conversation.id,n.conversations[t.payload.conversation.conversation.id]=t.payload.conversation},RECEIVE_MESSAGES_FOR_CONVERSATION:function receiveMessagesForConversationHandler(e){var t=e.action,n=e.draft,a=t.payload,r=a.messages,c=a.conversationId,i=a.hasMoreMessages,o=void 0!==i&&i,u=a.nextPageMessageId,s=void 0===u?null:u;n.messages[c]=Object(b.a)(Object(b.a)({},n.messages[c]),Object(G.a)(r)),n.conversations[c]=Object(b.a)(Object(b.a)({},n.conversations[c]),{},{hasMoreMessages:o,nextPageMessageId:s});var d=r.filter(function unreadAgentMessages(e){return e.viewerRecipientStatus!==H.f.READ&&e.authorType===H.b.USER&&!!e.body&&!!e.body.length}).map(function(e){return e.id});n.unreadAgentMessages[c]=d;r.filter(function hasNonEmptyEndUserMessages(e){return(e.authorType===H.b.END_USER||e.authorType===H.b.LEAD)&&!!e.body&&!Object(P.a)(e.body)}).length>0&&F(n,c,{endUserResponded:!0})},RECEIVE_BULK_CONVERSATIONS:function receiveBulkConversationsHandler(e){var t=e.action,n=e.draft,a=t.payload.conversations.reduce(function(e,t){return e[t.conversation.id]=t,e},{});n.conversations=Object(U.a)(n.conversations,a)},SET_ACTIVE_CONVERSATION:function setActiveConversationHandler(e){var t=e.action;e.draft.activeConversation=t.payload.conversationId},CLEAR_ACTIVE_CONVERSATION:function clearActiveConversationHandler(e){e.draft.activeConversation=null},RECEIVE_READ_MESSAGES:function sendReadReceiptHandler(e){var t=e.action,n=e.draft,a=t.payload.conversationId;n.unreadAgentMessages[a]=[]},SET_UNREAD_MESSAGE:function setUnreadMessageHandler(e){var t=e.action,n=e.draft,a=t.payload.message;n.unreadAgentMessages[a.conversationId]?n.unreadAgentMessages[a.conversationId].push(a.id):n.unreadAgentMessages[a.conversationId]=[a.id]},RECEIVE_ATTACHMENTS:function receiveAttachments(e){var t=e.action,n=e.draft;n.attachments=Object(b.a)(Object(b.a)({},n.attachments),Object(w.a)(t.payload.attachments))},RECEIVE_IS_TYPING:function setIsTypingHandler(e){var t=e.action;e.draft.typingIndicators[t.payload.conversationId]=t.payload},SET_ACTIVE_DRIFTLINK:function setActiveDriftlinkHandler(e){var t=e.action;e.draft.activeDriftlink=t.payload},RECEIVE_AGENT_STATUS:function receiveAgentStatusHandler(e){var t=e.action,n=e.draft,a=t.payload,r=a.agentId,c=a.availability,i=a.lastActivity;n.agentPresence[r]={status:c,lastActivity:i}},RECEIVED_MATCHED_CONVO_ROUTING_RULES:function receiveMatchedConversationRoutingRulesHandler(e){var t=e.action;e.draft.matchedRoutingRules=t.payload},PERMACLOSE_CONVERSATION:function permacloseConversation(e){var t=e.action,n=e.draft,a=t.payload.conversationId;F(n,a,{permaclosed:!0})},SET_HAS_FORCED_CONVERSATION:function setHasForcedConversationHandler(e){e.draft.hasForcedConversation=!0}},$=Object(i.b)({endUserEngaged:!1,activeConversation:null,activeDriftlink:null,attachments:{},conversations:{},conversationStatus:{},typingIndicators:{},agentMessagesFromCurrentSession:{},messages:{},unreadAgentMessages:{},matchedRoutingRules:[],agentPresence:{},resumeFlowContext:{},hasForcedConversation:!1},W),K=n("qwiD"),J=n("OA1u"),Y=n("Jstd"),Z=n("vTYT"),q=n("8saY"),Q=n("Nlet"),X=n("VYE+"),z=n("7oto"),ee=n("EQxi"),te=["drift.click","drift.me","drift.com","driftqa.com","driftqa.me","driftqa.click"];var ne=function handleWhitelistedUrls(){(function isWhitelistedUrl(){var e=Object(Q.c)().url,t=Object(h.a)([],["embed","configuration","theme","urlWhitelist"],O.a.getState());if(Object(P.a)(t))return!0;if(Object(Y.a)(function(t){return e.includes(t)})(te))return!0;var n=t.map(function(e){return Object(ee.e)(e)});return!!Object(Y.a)(function(t){return e.includes(t)})(n)||(console.warn("The Drift widget is not allowed to load on this domain: ".concat(e)),!1)})()||Object(z.a)({topic:"destroy-drift"})},ae=function handleFrameAlignment(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0)||Object(g.i)();e===Z.a.LEFT&&Object(z.a)({topic:"align-frames",message:{alignment:e}})},re=function processCustomIconPlacement(e){var t=Object(w.i)(navigator.userAgent)?"mobile":"desktop";if(Object(h.a)(q.d.DEFAULT,["configuration","theme","widgetIconPosition",t,"type"],e)!==q.d.DEFAULT){var n=e.configuration.theme.widgetIconPosition[t].spacing.bottom;Object(z.a)({topic:"update-frame-vertical-offset",message:{offset:n}})}},ce=function overrideVerticalOffset(e){Object(L.a)(e)||Object(z.a)({topic:"update-frame-vertical-offset",message:{offset:e}})},ie=function overrideCookieDomain(e){if(e){var t=Object(X.f)([e]);t&&O.a.dispatch(Object(K.i)({cookieDomain:t}))}};var oe=n("FgEv"),ue={configuration:{gates:[],dataProtection:{},theme:{awayMessage:null,welcomeMessage:null,team:[],userList:[],userListMode:void 0}},overrides:{}},se={RECEIVE_EMBED_CONFIGURATION:function receiveEmbedConfigurationHandler(e){var t=e.action,n=e.draft,a=Object(b.a)(Object(b.a)({},n.configuration),t.payload.configuration);return Object(b.a)(Object(b.a)({},t.payload),{},{configuration:Object(oe.a)(a,n.overrides),overrides:n.overrides})},RECIEVE_EMBED_AWAY_MESSAGE:function receiveEmbedAwayMessageHandler(e){var t=e.action,n=e.draft,a=t.payload.message;void 0!==a&&a&&(n.configuration.theme.awayMessage=t.payload.message)},RECEIVE_EMBED_WELCOME_MESSAGE:function receiveEmbedWelcomeMessageHandler(e){var t=e.action,n=e.draft,a=t.payload,r=a.message,c=a.authorId;n.configuration.theme.welcomeMessage=r,c&&(n.configuration.autoAssigneeId=c)},RECEIVE_EMBED_CONFIGURATION_OVERRIDE:function receiveEmbedConfigurationOverrideHandler(e){var t=e.action,n=e.draft;n.overrides=t.payload,n.configuration=Object(oe.a)(n.configuration,t.payload)}},de=Object(i.b)(ue,se),le={RECEIVE_IDENTITY_MAP:function receiveIdentityMapHandler(e){var t=e.action;e.draft;return t.payload}},fe=Object(i.b)({},le),be=n("WwEg"),pe=n("0B8E"),ve=n("TbSn"),Oe=n("U505"),Ee={SET_HAS_SENT_IMPRESSION:function setHasSentImpressionHandler(e){e.draft.hasSentImpression=!0},RECEIVE_ACTIVE_CAMPAIGN:function receiveNewBotCampaignMessageHandler(e){var t=e.action,n=e.draft,a=Object(h.a)({},["data"],t.payload),r=Object(V.a)(a,"playbookId");n.active=Object(pe.a)([].concat(Object(be.a)(n.active),[r]))},RECEIVE_INITIAL_ACTIVE_CONVERSATION:function receiveInitialActiveConversationHandler(e){var t=e.action,n=e.draft,a=Object(h.a)(null,["payload","conversation","conversation","id"],t);a&&(n.initialConversationId=a)},RECEIVE_MESSAGES_FOR_CONVERSATION:function receiveMessagesForConversationHandler(e){var t=e.action,n=e.draft,a=t.payload.messages,r=Object(ve.a)(t.payload.messages),c=Object(V.e)(r,"startInteraction"),i=Object(Y.a)(function(e){return e.viewerRecipientStatus===H.f.READ},a);if(c&&i&&r.conversationId===n.initialConversationId){var o=Object(V.a)(r,"playbookId");n.passive=Object(pe.a)([].concat(Object(be.a)(n.passive),[o]))}},REMOVE_TRIGGERABLE_CAMPAIGN_IMPRESSION:function removeTriggerableCampaignImpressionHandler(e){var t=e.action,n=e.draft,a=t.payload,r=a.source,c=a.playbookId;"active"===r?n.active=Object(Oe.a)([c],n.active):"passive"===r&&(n.passive=Object(Oe.a)([c],n.passive))}},ge=Object(i.b)({hasSentImpression:!1,initialConversationId:null,active:[],passive:[]},Ee),me={RECEIVE_MARKED_TIME:function handleReceiveMarkedtime(e){var t=e.action;e.draft.timeByName[t.payload.name]=t.payload.time},RECEIVE_INIT_TIMESTAMP:function receiveInitTimestampHandler(e){var t=e.action;e.draft.initTimestamp=t.payload},RECEIVE_SERVER_RESPONSE_SIZE:function receiveServerResponseSizeHandler(e){var t=e.action,n=e.draft,a=t.payload.size;n.loadCostInBytes+=a}},Ie=Object(i.b)({loadCostInBytes:0,initTimestamp:null,timeByName:{}},me),je=n("SHZQ"),_e=n("BAMi"),he=n("FAmh"),ye=n("mfas"),Ce=function(){var e=Object(p.a)(f.a.mark(function _callee(){var e,t,n,a,r,c,i,o;return f.a.wrap(function _callee$(u){for(;;)switch(u.prev=u.next){case 0:return e=O.a.getState(),t=e.embed,n=void 0===t?{}:t,a=Object(he.b)(),r=Object(ye.a)(["inboxId"],a),u.next=5,Object(je.c)(n.id,r);case 5:if(c=u.sent,i=c.data){u.next=9;break}return u.abrupt("return");case 9:return u.next=11,Object(_e.c)(i.routingEvaluationResults);case 11:o=u.sent,O.a.dispatch(Object(N.r)(o));case 13:case"end":return u.stop()}},_callee)}));return function reevaluateRoutingRules(){return e.apply(this,arguments)}}(),Ae={IDENTIFY_LEAD:function identifyLeadHandler(e){var t=e.action;e.draft.endUser.email=t.payload},RECEIVE_GEO:function receiveGeoHandler(e){var t=e.action;e.draft.geo=t.payload},RECEIVE_ACCESS_TOKEN:function receiveAccessTokenHandler(e){var t=e.action;e.draft.auth.accessToken=t.payload.accessToken},RECEIVE_CHAT_SOCKET_AUTH:function receiveChatSocketAuthHandler(e){var t=e.action,n=e.draft;n.auth.socket=Object(b.a)(Object(b.a)({},n.auth.socket),{},{chat:t.payload})},RECEIVE_PRESENCE_SOCKET_AUTH:function receivePresenceSocketAuthHandler(e){var t=e.action,n=e.draft;n.auth.socket=Object(b.a)(Object(b.a)({},n.auth.socket),{},{visitor_presence:t.payload})},RECEIVE_SOCKET:function receiveSocketHandler(e){var t=e.action,n=e.draft,a=Object(h.a)(null,["payload","cluster"],t);a&&(n.sockets[a]={channels:{}})},RECEIVE_CHANNEL:function receiveChannelHandler(e){var t=e.action,n=e.draft,a=Object(h.a)(null,["payload","cluster"],t);a&&(n.sockets[a].channels[t.payload.key]=t.payload.channel)},RECEIVE_END_USER:function receiveEndUserHandler(e){var t=e.action,n=e.draft,a=!!t.payload.assignedAgentId;n.endUser=Object(b.a)(Object(b.a)({},n.endUser),t.payload.endUser),n.isOutbound=a,a&&(n.assignedAgentId=t.payload.assignedAgentId)},RECEIVE_EXTERNAL_ID:function receiveExternalIdHandler(e){var t=e.action;e.draft.endUser.externalId=t.payload},UPDATE_INSTANCE_ID:function updateInstanceIdHandler(e){var t=e.action;e.draft.instanceId=t.payload},RECEIVE_EXTERNAL_EMAIL:function receiveExternalEmailHandler(e){var t=e.action;e.draft.endUser.externalEmail=t.payload},RECEIVE_EXTERNAL_JWT:function receiveExternalJwtHandler(e){var t=e.action,n=e.draft;n.endUser.userJwt=t.payload,n.endUser.waitForUserJwt=!1},WAIT_FOR_EXTERNAL_JWT:function waitForExternalJwtHandler(e){e.action;e.draft.endUser.waitForUserJwt=!0},RECEIVE_GDPR:function receiveGDPRHandler(e){var t=e.action,n=e.draft;n.gdpr=Object(b.a)(Object(b.a)({},n.gdpr),t.payload)},RECEIVE_CONTEXT:function receiveContextHandler(e){var t=e.action;e.draft.context=t.payload},RECEIVE_SESSION:function receiveSessionHandler(e){var t=e.action,n=e.draft;n.id=t.payload.session.sessionId,n.sessionStarted=t.payload.session.sessionStarted,n.campaignRefreshToken=t.payload.session.campaignRefreshToken,n.instanceId=t.payload.session.instanceId},RECEIVE_COOKIE_DOMAIN:function receiveCookieDomainHandler(e){var t=e.action,n=e.draft,a=Object(h.a)(null,["payload","cookieDomain"],t);n.cookieDomain=a},RECEIVE_UPDATED_CAMPAIGN_REFRESH_TOKEN:function receiveUpdatedCampaignRefreshTokenHandler(e){var t=e.action;e.draft.campaignRefreshToken=t.payload}},Se=Object(i.b)({geo:{},auth:{},sockets:{},endUser:{},isOutbound:!1,gdpr:{needsConsent:!0,hasConsent:!1},instanceId:"",id:null,sessionStarted:null,cookieDomain:"",context:{page:{},timezone:"",userAgent:"",locale:""}},Ae),Te={UPDATE_ONLINE_STATUS:function updateOnlineStatusHandler(e){var t=e.action;e.draft.isOnline=t.payload},SET_SHOULD_SKIP_CAMPAIGNS:function setShouldSkipCampaignsHandler(e){var t=e.action;e.draft.skipCampaigns=t.payload},SET_SHOULD_FORCE_SHOW_WIDGET:function setShouldForceShowWidgetHandler(e){var t=e.action;e.draft.forceShowWidget=t.payload},SET_SHOULD_SKIP_WIDGET_TARGETING:function setShouldSkipWidgetTargetingHandler(e){var t=e.action;e.draft.skipWidgetTargeting=t.payload}},xe=Object(i.b)({skipCampaigns:!1,skipWidgetTargeting:!1,forceShowWidget:!1,isOnline:!1},Te),ke=n("vjCh"),Re=n("TDUE"),Me=n("Jg5f"),we=n("MFhO"),Ne={INIT_COMPLETE:function toggleInitCompleteHandler(e){var t=e.action;e.draft.initComplete=t.payload.initComplete},SET_CLOSE_CHAT_REDIRECT_URL:function setCloseChatRedirectUrl(e){var t=e.action;e.draft.closeChatRedirectUrl=t.payload},TOGGLE_CHAT:function toggleChatHandler(e){var t=e.action,n=e.draft;n.chatOpen=t.payload.chatOpen,n.isChatTakeover=!!t.payload.isChatTakeover,n.isChatTakeover&&(n.conversationHistoryOpen=!1)},TOGGLE_CONVERSATION_HISTORY:function toggleConversationHistoryHandler(e){var t=e.action;e.draft.conversationHistoryOpen=t.payload.conversationHistoryOpen},TOGGLE_WIDGET_TARGETING_MATCHED:function toggleWidgetTargetingCompleteHandler(e){var t=e.action,n=e.draft,a=t.payload,r=a.matchedHours,c=a.matchedTargeting;Object(L.a)(r)||(n.matchedHours=r),Object(L.a)(c)||(n.matchedTargeting=c)}},De=Object(i.b)({chatOpen:!1,closeChatRedirectUrl:null,conversationHistoryOpen:!1,initComplete:!1,isChatTakeover:!1,matchedHours:!1,matchedTargeting:!1},Ne),Ve=n("9OUN"),Le=n("Obtf");n.d(t,"b",function(){return Ue}),n.d(t,"a",function(){return He});var Pe=Object(Ve.c)({view:De,embed:de,metrics:Ie,session:Se,targeting:xe,conversations:$,campaigns:d,identity:fe,impressions:ge}),Ue=function rootReducer(e,t){return"REPLACE_STATE"===t.type&&(e=t.payload.currentState),Pe(e,t)},He=Object(Le.a)(function onToggleChatEpic(e){return e.pipe(Object(i.c)("TOGGLE_CHAT"),Object(M.a)(function(){return"controller"===O.a.name}),Object(r.a)(function(e){var t=e.payload;Object(E.d)(t.chatOpen),t.chatOpen&&Object(a.b)()}),Object(c.a)())},function onCloseChatCompleteCampaignEpic(e){return e.pipe(Object(i.c)("TOGGLE_CHAT"),Object(M.a)(function(){return"controller"===O.a.name}),Object(M.a)(function(e){return!e.payload.chatOpen}),Object(Me.a)(function(){return function activeCampaign(e){return e.campaigns.activeCampaign}(O.a.getState())}),Object(M.a)(function(e){return!!e}),Object(M.a)(function(e){return Object(h.a)(null,["attributes","campaignDisplayType"],e)===we.a.WELCOME_MESSAGE}),Object(r.a)(function(e){var t=Object(h.a)(null,["id"],e),n=Object(h.a)(null,["attributes","playbookId"],e);Object(ke.g)(t,n),Object(Re.c)(n)}),Object(c.a)())},function sendMessageEpic(e,t){return e.pipe(Object(i.c)("SEND_MESSAGE"),Object(M.a)(function(){return"controller"===O.a.name}),Object(r.a)(function(){var e=Object(p.a)(f.a.mark(function _callee(e){var n,a,r,c,i,o,u,s,d,l,p;return f.a.wrap(function _callee$(f){for(;;)switch(f.prev=f.next){case 0:return n=e.payload,a=Object(h.a)(null,["activeCampaign"],t.value.campaigns),r=Object(g.e)(),c=t.value.conversations.activeConversation,i=Object(_.c)(c),o=function defaultAttributes(){var e=a.id,n=e?t.value.campaigns.campaignEvalId:null,c=Object(h.a)([],["matchedRoutingRules"],t.value.conversations),i=c.map(function(e){return e.id}),o=c.length?Object(k.a)(Object(R.a)(function(e){return e.priority}),c[0],c):null;return Object(b.a)(Object(b.a)(Object(b.a)(Object(b.a)(Object(b.a)(Object(b.a)({},r?{locale:r}:{}),n?{targetingEvalUUID:n}:{}),o?{targetingRuleId:o.id}:{}),i.length?{targetingRuleIds:i}:{}),e?{campaignId:e,relatedCampaignId:e,isExpandable:!0}:{}),{},{integrations:Object(m.b)()})},u=function getConversationId(){return Object(h.a)(!1,["attributes","liveViewInitiated"],a)?Object(h.a)(null,["attributes","conversationId"],a):!i&&c?c:void 0},s=Object(b.a)(Object(b.a)({},n.message),{},{conversationId:u(),attributes:Object(b.a)(Object(b.a)(Object(b.a)({},n.message.attributes?n.message.attributes:{}),o()),i?t.value.conversations.resumeFlowContext:{})}),f.prev=8,f.next=11,C(s);case 11:d=f.sent,l=d.data,O.a.dispatch(Object(N.i)({message:l,isPreRendered:i,isNew:!n.message.conversationId})),f.next=20;break;case 16:f.prev=16,f.t0=f.catch(8),(p=Object(h.a)(null,["response","status"],f.t0))&&403===p||Object(w.e)(new Error("Failed To send message"),f.t0);case 20:case"end":return f.stop()}},_callee,null,[[8,16]])}));return function(t){return e.apply(this,arguments)}}()),Object(c.a)())},function receiveMessageSentEpic(e,t){return e.pipe(Object(i.c)("RECEIVE_MESSAGE_SENT"),Object(M.a)(function(){return"controller"===O.a.name}),Object(r.a)(function(e){var t=e.payload.message;Object(_.a)(t)||Object(E.e)(t)}),Object(c.a)())},function onReceiveEmbedEpic(e){return e.pipe(Object(i.c)("RECEIVE_EMBED_CONFIGURATION"),Object(M.a)(function(){return"controller"===O.a.name}),Object(r.a)(function(e){return function processPayload(e){ae(),ne(),re(e)}(e.payload)}),Object(c.a)())},function pushToChannelEpic(e,t){return e.pipe(Object(i.c)("PUSH_TO_CHANNEL"),Object(r.a)(function(e){var n=e.meta,a=e.payload,r=n||{},c=r.clusterName,i=r.channelName,o=r.eventName;if(o&&c&&i){var u=Object(h.a)(null,["session","sockets",c,"channels",i],t.value);u&&u.push(o,a)}}),Object(c.a)())},function updateEndUserEmailEpic(e,t){return e.pipe(Object(i.c)("IDENTIFY_LEAD"),Object(M.a)(function(){return"controller"===O.a.name}),Object(r.a)(function(){var e=Object(p.a)(f.a.mark(function _callee(e){var t;return f.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload.email,n.next=3,Object(m.c)({email:t});case 3:Object(E.h)({email:t}),Ce();case 5:case"end":return n.stop()}},_callee)}));return function(t){return e.apply(this,arguments)}}()),Object(c.a)())},function onReceiveEmbedOverrideEpic(e){return e.pipe(Object(i.c)("RECEIVE_EMBED_CONFIGURATION_OVERRIDE"),Object(M.a)(function(){return"controller"===O.a.name}),Object(r.a)(function(e){return function processOverridePayload(e){e&&Object.keys(e).forEach(function(t){var n=e[t];switch(t){case"verticalOffset":ce(n);break;case"cookieDomain":ie(n);break;case"campaignsEnabled":O.a.dispatch(Object(J.b)(!n))}})}(e.payload)}),Object(c.a)())},function checkPermacloseConversationEpic(e,t){return e.pipe(Object(i.c)("SET_ACTIVE_CONVERSATION"),Object(M.a)(function(){return"controller"===O.a.name}),Object(r.a)(function(){var e=Object(p.a)(f.a.mark(function _callee2(e){var n,a,r;return f.a.wrap(function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:if(!((n=e.payload.conversationId)<0)){c.next=3;break}return c.abrupt("return");case 3:if(!Object(h.a)(!1,["conversations","conversationStatus",n,"permaclosed"],t.value)){c.next=6;break}return c.abrupt("return");case 6:return c.next=8,Object(v.e)(n);case 8:a=c.sent,void 0!==(r=a.data.sentMessage)&&r&&O.a.dispatch(Object(N.b)({conversationId:n}));case 12:case"end":return c.stop()}},_callee2)}));return function(t){return e.apply(this,arguments)}}()),Object(c.a)())},function resizeControllerAfterCampaignClear(e,t){return e.pipe(Object(i.c)("CLEAR_ACTIVE_CAMPAIGN"),Object(r.a)(function(){var e=t.value.view;(void 0===e?{}:e).matchedTargeting||Object(a.a)()}),Object(c.a)())})},bYXQ:function(e,t,n){"use strict";n.d(t,"c",function(){return u}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return d});var a=n("QtlZ"),r=n("+/Je"),c=n("LVcX"),i=n("DboL"),o=n("PjZB"),u=function isPrerenderedConversation(e){return e===r.b},s=function isNewConversation(e){return e===r.a},d=function conversationHasEndUserMessage(e){var t=Object(c.a)(null,["conversations","messages",e.conversationId.toString()],a.a.getState());return t&&Object(i.a)(t).some(function(t){return t.authorType!==o.b.USER&&!!t.body&&t.id!==e.id})}},da4L:function(e,t,n){"use strict";n.d(t,"l",function(){return m}),n.d(t,"m",function(){return I}),n.d(t,"n",function(){return j}),n.d(t,"d",function(){return h}),n.d(t,"g",function(){return y}),n.d(t,"i",function(){return C}),n.d(t,"a",function(){return A}),n.d(t,"e",function(){return S}),n.d(t,"h",function(){return T}),n.d(t,"j",function(){return x}),n.d(t,"o",function(){return M}),n.d(t,"c",function(){return w}),n.d(t,"b",function(){return N}),n.d(t,"f",function(){return D}),n.d(t,"k",function(){return V});var a=n("nfbA"),r=n("8lq6"),c=n("oQJ1"),i=n("dMPp"),o=n("yzXs"),u=n("YsSj"),s=n("DboL"),d=n("RhEL"),l=n("CDfd"),f=n("hm8b"),b=n("LVcX"),p=n("Jstd"),v=n("Ry6R"),O=n("A5mO"),E=n("PjZB"),g=n("0lfv"),m=Object(r.a)([Object(c.a)(Object(i.a)("createdAt"))]),I=function shouldReceiveMessage(e){var t=e.contentType===E.c.CHAT&&(!!e.body.length||!!e.attributes.appointmentInfo||!!e.attributes.startInteraction),n=e.contentType===E.c.EMAIL_CAPTURE_CARD,a=e.attachments&&e.attachments.length>0,r=x(e)||k(e);return t||n||a||r},j=Object(o.a)(Object(u.a)(function(e){return!!e.body||!S(e,"startInteraction")}),Object(u.a)(I),m,s.a),_=function shouldGroupMessages(e,t){return C(e)&&C(t)||Object(d.a)(e.authorType,t.authorType)&&Object(d.a)(e.authorId,t.authorId)&&Object(O.a)(t.attributes.generatedAt||t.createdAt).isBefore(Object(O.a)(e.attributes.generatedAt||e.createdAt).add(2,"hour"))},h=function groupMessages(e){return Object(l.a)(_,e)},y=function isEmptyMessage(e){return!e||!e.replace(/<\/?p[^>]*>/g,"").trim()},C=function isMeetingScheduleMessage(e){var t=e.attributes,n=t.offerSchedule,a=t.presentSchedule,r=t.scheduleMeetingFlow,c=t.appointmentInfo;return!Object(f.a)(n)||!Object(f.a)(a)||!Object(f.a)(r)||!Object(f.a)(c)},A=function getMessageAttribute(e,t){return Object(b.a)(null,["attributes",t],e)},S=function hasMessageAttribute(e,t){return!!A(e,t)},T=function isEndUserMessage(e){return!!e&&(e.authorType===E.b.LEAD||e.authorType===E.b.END_USER)},x=(Object(p.a)(function(e){return e.authorType===E.b.USER&&!S(e,"isBot")}),function isRateConversationCTAMessage(e){return"BOT_CONVERSATION_RATING"===e.contentType&&e.authorType===E.b.USER&&S(e,"ratingPrompt")}),k=function isConversationRatingMessage(e){return"BOT_CONVERSATION_RATING"===e.contentType&&S(e,"conversationRating")},R=function truncateMessageText(e){return Object(v.a)(100,e)[0].trim()},M=function truncateMessagePreview(e,t){var n=A(e,"preview");if(n&&n.length>t){var r=R(n);return Object(a.a)(Object(a.a)({},e),{},{attributes:Object(a.a)(Object(a.a)({},e.attributes),{},{preview:"".concat(r,"...")})})}return e},w=function getMessagePreviewText(e){return"BOT_CONVERSATION_RATING"===e.contentType?R(A(e,"ratingPrompt").ratingPromptMessage):A(e,"preview")},N=function getMessageCreatedAt(e){return e.createdAt||A(e,"generatedAt")},D=function isButtonsOnlyMessage(e){return!!e&&!T(e)&&!!A(e,"isButtonOnly")&&!Object(g.j)(A(e,"buttons"))},V=function messageContainsButtons(e){return!!e&&!T(e)&&!Object(g.j)(A(e,"buttons"))}},g6eD:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return i}),n.d(t,"e",function(){return o}),n.d(t,"a",function(){return u});var a=n("Cpup"),r=function toggleChat(e){return Object(a.a)({type:"TOGGLE_CHAT",payload:e})},c=function toggleConversationHistory(e){return Object(a.a)({type:"TOGGLE_CONVERSATION_HISTORY",payload:e})},i=function toggleInitComplete(e){return Object(a.a)({type:"INIT_COMPLETE",payload:e})},o=function toggleMatchedWidgetTargeting(e){return Object(a.a)({type:"TOGGLE_WIDGET_TARGETING_MATCHED",payload:e})},u=function setCloseChatRedirectUrl(e){return Object(a.a)({type:"SET_CLOSE_CHAT_REDIRECT_URL",payload:e})}},jbOz:function(e,t,n){"use strict";var a=n("nfbA"),r=n("mj2O"),c=n.n(r),i=n("7SM1"),o=n("uIJS"),u=n("LvsC"),s=n("qytN"),d=n("7jL2"),l=n("vEWT"),f=n("QtlZ"),b=n("LVcX"),p=n("YvIt"),v=n("0lfv"),O=n("Nlet"),E=n("7BJg"),g=n("t8ds");function _createSuper2(e){return function(){var t,n=Object(d.a)(e);if(function isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(d.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(s.a)(this,t)}}var m=2e3,I=function(e){Object(u.a)(UsageMetricEventBuffer,e);var t=_createSuper2(UsageMetricEventBuffer);function UsageMetricEventBuffer(){var e;return Object(o.a)(this,UsageMetricEventBuffer),(e=t.call(this,m))._publishBuffer=Object(i.a)(c.a.mark(function _callee(){var t;return c.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return e._events.length||Promise.reject(void 0),n.next=3,e._hydrateEvents();case 3:return t=n.sent,n.next=6,Object(l.b)(t).catch(function(e){Object(v.k)({type:"warn",data:["Bulk Usage Metrics Failure"]})});case 6:e._resetBuffer();case 7:case"end":return n.stop()}},_callee)})),e._hydrateEvents=Object(i.a)(c.a.mark(function _callee2(){var t,n,r,i,o,u,s,d,l,E,m,I;return c.a.wrap(function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,g.b.get(p.a);case 2:return t=c.sent,n=t.data,r=f.a.getState(),i=r.session,o=r.embed,u=r.metrics,s=Object(b.a)("",["geo","country"],i),d=Object(b.a)("",["context","userAgent"],i),l=Object(v.i)(d),E=Object(O.c)(),m=u.loadCostInBytes,I=e._events.map(function(e){return"loaded"===e.eventName&&(e.attributes.loadSizeInBytes=m),{eventName:"[V2] - ".concat(e.eventName),embedId:o.id,sessionId:n,instanceId:i.instanceId,attributes:Object(a.a)(Object(a.a)({},e.attributes),{},{isMobile:l})}}),c.abrupt("return",Promise.resolve({id:Object(v.p)(),events:I,timestamp:Date.now(),context:{country:s,locale:E.locale,timezone:E.timezone,url:E.url}}));case 12:case"end":return c.stop()}},_callee2)})),e}return UsageMetricEventBuffer}(E.a);t.a=new I},pvgo:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n("QtlZ"),r=n("4c+F"),c=n("CYoe"),i=function stashLoadRequestResponseSize(e){if(!a.a.getState().view.initComplete){var t=Object(r.b)(e);a.a.dispatch(Object(c.c)({size:t}))}}},qwiD:function(e,t,n){"use strict";n.d(t,"o",function(){return r}),n.d(t,"h",function(){return c}),n.d(t,"e",function(){return i}),n.d(t,"g",function(){return o}),n.d(t,"p",function(){return u}),n.d(t,"r",function(){return s}),n.d(t,"f",function(){return d}),n.d(t,"j",function(){return l}),n.d(t,"k",function(){return f}),n.d(t,"m",function(){return b}),n.d(t,"b",function(){return p}),n.d(t,"u",function(){return v}),n.d(t,"s",function(){return O}),n.d(t,"l",function(){return E}),n.d(t,"c",function(){return g}),n.d(t,"a",function(){return m}),n.d(t,"n",function(){return I}),n.d(t,"q",function(){return j}),n.d(t,"t",function(){return _}),n.d(t,"i",function(){return h}),n.d(t,"d",function(){return y});var a=n("Cpup"),r=function receiveGeo(e){return Object(a.a)({type:"RECEIVE_GEO",payload:e})},c=function receiveContext(e){return Object(a.a)({type:"RECEIVE_CONTEXT",payload:e})},i=function receiveAccessToken(e){return Object(a.a)({type:"RECEIVE_ACCESS_TOKEN",payload:e})},o=function receiveChatSocketAuth(e){return Object(a.a)({type:"RECEIVE_CHAT_SOCKET_AUTH",payload:e})},u=function receivePresenceSocketAuth(e){return Object(a.a)({type:"RECEIVE_PRESENCE_SOCKET_AUTH",payload:e})},s=function receiveSocket(e){return Object(a.a)({type:"RECEIVE_SOCKET",payload:e})},d=function receiveChannel(e){return Object(a.a)({type:"RECEIVE_CHANNEL",payload:e})},l=function receiveEndUser(e){return Object(a.a)({type:"RECEIVE_END_USER",payload:e})},f=function receiveExternalEmail(e){return Object(a.a)({type:"RECEIVE_EXTERNAL_EMAIL",payload:e})},b=function receiveExternalJwt(e){return Object(a.a)({type:"RECEIVE_EXTERNAL_JWT",payload:e})},p=function clearExternalJwt(){return b(null)},v=function waitForExternalJwt(){return Object(a.a)({type:"WAIT_FOR_EXTERNAL_JWT"})},O=function receiveUpdatedCampaignRefreshToken(e){return Object(a.a)({type:"RECEIVE_UPDATED_CAMPAIGN_REFRESH_TOKEN",payload:e})},E=function receiveExternalId(e){return Object(a.a)({type:"RECEIVE_EXTERNAL_ID",payload:e})},g=function identifyLead(e){return Object(a.a)({type:"IDENTIFY_LEAD",payload:e})},m=function clearExternalId(){return E(null)},I=function receiveGDPR(e){return Object(a.a)({type:"RECEIVE_GDPR",payload:e})},j=function receiveSession(e){return Object(a.a)({type:"RECEIVE_SESSION",payload:e})},_=function updateInstanceId(e){return Object(a.a)({type:"UPDATE_INSTANCE_ID",payload:e})},h=function receiveCookieDomain(e){return Object(a.a)({type:"RECEIVE_COOKIE_DOMAIN",payload:e})},y=function pushToChannel(e,t,n,r){return Object(a.a)({type:"PUSH_TO_CHANNEL",meta:{clusterName:e,channelName:t,eventName:n},payload:r})}},r0JT:function(e,t,n){"use strict";var a=n("uIJS"),r=n("LvsC"),c=n("qytN"),i=n("7jL2"),o=n("vEWT"),u=n("0lfv"),s=n("7BJg");function _createSuper2(e){return function(){var t,n=Object(i.a)(e);if(function isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(i.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(c.a)(this,t)}}var d=5e3,l=function(e){Object(r.a)(MetricEventBuffer,e);var t=_createSuper2(MetricEventBuffer);function MetricEventBuffer(){var e;return Object(a.a)(this,MetricEventBuffer),(e=t.call(this,d))._publishBuffer=function(){e._events.length&&(Object(o.a)(e._events).catch(function(e){Object(u.k)({type:"warn",data:["Bulk Metrics Failure"]})}),e._resetBuffer())},e}return MetricEventBuffer}(s.a);t.a=new l},vjCh:function(e,t,n){"use strict";var a=n("mj2O"),r=n.n(a),c=n("7SM1"),i=n("nfbA"),o=n("xXFf"),u=n("QtlZ"),s=n("SsZN"),d=n("Wjfv"),l=n("K7i0"),f=n("SFoa"),b=n("y0Ar"),p=n("TDUE"),v=n("da4L"),O=n("mfas"),E=n("LVcX"),g=n("MFhO"),m=n("PjZB"),I=n("0lfv"),j=n("9ttK");n.d(t,"a",function(){return _}),n.d(t,"b",function(){return h}),n.d(t,"g",function(){return y}),n.d(t,"f",function(){return C}),n.d(t,"c",function(){return A}),n.d(t,"e",function(){return S}),n.d(t,"d",function(){return x});var _=function assignActiveCampaignFromEmbed(e,t){var n=Object(j.a)(e,["displayType"]),a={id:e.id,attributes:Object(i.a)(Object(i.a)({},e.attributes),{},{message:t,campaignId:e.id,campaignDisplayType:n})};u.a.dispatch(Object(d.b)({data:a}))},h=function assignActiveCampaignFromMessage(e){var t=Object(v.a)(e,"campaignId");if(!t&&Object(v.e)(e,"startInteraction")){var n=Object(v.a)(e,"startInteraction");t=Object(f.c)(n)}var a=Object(O.a)(["attributes"],e),r={id:t,attributes:e.attributes||{},message:a};u.a.dispatch(Object(d.b)({data:r}))},y=function(){var e=Object(c.a)(r.a.mark(function _callee(e,t){var n;return r.a.wrap(function _callee$(a){for(;;)switch(a.prev=a.next){case 0:if(e){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,k(e);case 4:if(n=x(e),Object(j.a)(n,["campaignReenrollmentType"],null)!==g.b.ALWAYS){a.next=10;break}return a.next=9,Object(p.c)(t);case 9:return a.abrupt("return");case 10:case"end":return a.stop()}},_callee)}));return function storeAnnouncementCampaignCompleted(t,n){return e.apply(this,arguments)}}(),C=function showUnreadCampaign(e){var t=u.a.getState(),n=t.conversations,a=void 0===n?{}:n,r=t.campaigns,c=void 0===r?{}:r,o=a.activeDriftlink;if(!c.activeCampaign.id&&!o){var d=function getUnreadCampaignsById(){var e=u.a.getState().campaigns.unreadCampaigns,t={},n=!0,a=!1,r=void 0;try{for(var c,i=e[Symbol.iterator]();!(n=(c=i.next()).done);n=!0){var o=c.value,s=Object(E.a)(null,["conversation","campaignId"],o);if(!s)return null;t[s]=o}}catch(d){a=!0,r=d}finally{try{n||null==i.return||i.return()}finally{if(a)throw r}}return t}()[e];if(d){var f=d.conversation,p=void 0===f?{}:f,O=d.messages,g=void 0===O?[]:O,m=g[0],I=Object(v.a)(m,"playbookId"),j=Object(v.a)(m,"interactionId");u.a.dispatch(Object(l.g)({conversation:{conversation:p}})),u.a.dispatch(Object(l.j)({conversationId:p.id,messages:g})),u.a.dispatch(Object(l.n)({conversationId:p.id})),Object(s.p)(Object(i.a)(Object(i.a)({},m),{},{id:null,conversationId:null})),h(m),Object(b.a)({playbookId:I,interactionId:j})}}},A=function evaluateCampaignConversations(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=T(e);u.a.dispatch(Object(d.e)(t))},S=function getUnreadCampaignIds(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return T(e).map(function(e){return e.conversation.campaignId})},T=function getUnreadCampaigns(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.filter(function(e){return function isBotCampaign(e){return"CHAT"===Object(E.a)(null,["conversation","type"],e)}(e)&&function isFirstMessageUnread(e){var t=e.messages.filter(function(e){return""!==e.body});return Object(E.a)(null,[0,"viewerRecipientStatus"],t)!==m.f.READ}(e)})},x=function getCampaignFromEmbedById(e){return Object(E.a)([],["embed","configuration","campaigns"],u.a.getState()).filter(function(t){return t.id===e})[0]},k=function(){var e=Object(c.a)(r.a.mark(function _callee2(e){var t,n,a,c;return r.a.wrap(function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:return t=u.a.getState(),n=t.session,a=void 0===n?{}:n,r.prev=1,c=Object(E.a)(null,["endUser","id"],a),r.next=5,Object(o.d)({endUserId:c,campaignId:e,sessionId:a.campaignRefreshToken});case 5:return r.abrupt("return",r.sent);case 8:return r.prev=8,r.t0=r.catch(1),Object(I.e)("Failed to persist campaign interaction: ".concat(r.t0.message)),r.abrupt("return",null);case 12:case"end":return r.stop()}},_callee2,null,[[1,8]])}));return function triggerCampaignInteractionEvent(t){return e.apply(this,arguments)}}()},ws1h:function(e,t,n){"use strict";n.d(t,"a",function(){return b}),n.d(t,"b",function(){return p});var a=n("mj2O"),r=n.n(a),c=n("7SM1"),i=n("SHZQ"),o=n("QtlZ"),u=n("OA1u"),s=n("LVcX"),d=n("0lfv"),l=n("moLG"),f=Object(l.a)(Object(c.a)(r.a.mark(function _callee(){var e,t,n;return r.a.wrap(function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return e=o.a.getState().embed.id,a.next=3,Object(i.d)(e);case 3:return t=a.sent,n=t.data,a.abrupt("return",n);case 6:case"end":return a.stop()}},_callee)})),5e3),b=function(){var e=Object(c.a)(r.a.mark(function _callee2(){var e,t;return r.a.wrap(function _callee2$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,f();case 3:return e=n.sent,t=Object(s.a)(!1,["driftOnline"],e),o.a.dispatch(Object(u.d)(t)),n.abrupt("return",t);case 9:return n.prev=9,n.t0=n.catch(0),Object(d.q)(["Failed to fetch online status -  ".concat(n.t0.message),n.t0]),n.abrupt("return",!1);case 13:case"end":return n.stop()}},_callee2,null,[[0,9]])}));return function getIsOnline(){return e.apply(this,arguments)}}(),p=function(){var e=Object(c.a)(r.a.mark(function _callee3(){var e,t,n,a;return r.a.wrap(function _callee3$(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,f();case 3:return e=r.sent,t=e.availableTeams||[],n=Object(s.a)([],["configuration","teams"],o.a.getState().embed),a={},n.forEach(function(e){var n=t.includes(e.id);a[e.id]={isOnline:n}}),r.abrupt("return",a);case 11:return r.prev=11,r.t0=r.catch(0),Object(d.q)(["Failed to fetch team availability",r.t0]),r.abrupt("return",{});case 15:case"end":return r.stop()}},_callee3,null,[[0,11]])}));return function getTeamAvailability(){return e.apply(this,arguments)}}()},y0Ar:function(e,t,n){"use strict";var a=n("QtlZ"),r=n("Cpup"),c=n("gG69"),i=n("TDUE");n.d(t,"a",function(){return o});var o=function sendPlaybookImpression(e){var t=e.playbookId,n=e.interactionId,o=e.conversationId,u=e.isVirtual,s=void 0!==u&&u,d=e.isDelayed,l=void 0!==d&&d,f=a.a.getState().impressions,b=f.active,p=void 0===b?[]:b,v=f.passive,O=void 0===v?[]:v,E=p.includes(t),g=O.includes(t);(E||g)&&(Object(i.d)(E?c.c.ACTIVE_PLAYBOOK:c.c.PASSIVE_PLAYBOOK,{playbookId:t,interactionId:n,conversationId:o,virtual:s,isDelayed:l})&&a.a.dispatch(function removeTriggerableCampaignImpression(e){return Object(r.a)({type:"REMOVE_TRIGGERABLE_CAMPAIGN_IMPRESSION",payload:e})}({source:E?"active":"passive",playbookId:t})))}},z8Kx:function(e,t,n){"use strict";n.d(t,"b",function(){return h}),n.d(t,"e",function(){return y}),n.d(t,"d",function(){return C}),n.d(t,"c",function(){return A}),n.d(t,"a",function(){return S});var a=n("mj2O"),r=n.n(a),c=n("7SM1"),i=n("QtlZ"),o=n("qwiD"),u=n("LVcX"),s=n("LelF"),d=n("8saY"),l=n("0lfv"),f=n("VYE+"),b=n("qeWU"),p=function getExternalId(){var e=i.a.getState().session;return Object(u.a)(null,["endUser","externalId"],e)},v=function(){var e=Object(c.a)(r.a.mark(function _callee(){var e,t;return r.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(f.e)(s.e);case 2:return e=n.sent,n.next=5,Object(f.e)(s.d);case 5:if(t=n.sent,!e){n.next=9;break}return Object(f.g)(s.d,e),n.abrupt("return",e);case 9:return n.abrupt("return",t||null);case 10:case"end":return n.stop()}},_callee)}));return function getExternalIdFromCookie(){return e.apply(this,arguments)}}(),O=function setExternalIdCookie(e){Object(f.g)(s.d,e)},E=function(){var e=Object(c.a)(r.a.mark(function _callee2(){return r.a.wrap(function _callee2$(e){for(;;)switch(e.prev=e.next){case 0:return i.a.dispatch(o.a()),e.next=3,Object(f.a)(s.d);case 3:if(!Object(f.d)()){e.next=6;break}return e.next=6,Object(f.a)(s.d,{domain:""});case 6:case"end":return e.stop()}},_callee2)}));return function clearExternalId(){return e.apply(this,arguments)}}(),g=function getUserJwt(){var e=i.a.getState().session;return Object(u.a)(void 0,["endUser","userJwt"],e)},m=function(){var e=Object(c.a)(r.a.mark(function _callee3(){var e;return r.a.wrap(function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.e)(s.f);case 2:if(!(e=t.sent)){t.next=10;break}if(!Object(b.b)(e)){t.next=9;break}return t.next=7,I();case 7:t.next=10;break;case 9:return t.abrupt("return",e);case 10:return t.abrupt("return",void 0);case 11:case"end":return t.stop()}},_callee3)}));return function getUserJwtFromCookie(){return e.apply(this,arguments)}}(),I=function(){var e=Object(c.a)(r.a.mark(function _callee4(){return r.a.wrap(function _callee4$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.a)(s.f);case 2:if(!Object(f.d)()){e.next=5;break}return e.next=5,Object(f.a)(s.f,{domain:""});case 5:case"end":return e.stop()}},_callee4)}));return function clearUserJwtCookie(){return e.apply(this,arguments)}}(),j=function setUserJwtCookie(e){Object(f.h)(s.f,e)},_=function(){var e=Object(c.a)(r.a.mark(function _callee5(){return r.a.wrap(function _callee5$(e){for(;;)switch(e.prev=e.next){case 0:return i.a.dispatch(o.b()),e.next=3,I();case 3:case"end":return e.stop()}},_callee5)}));return function clearUserJwt(){return e.apply(this,arguments)}}(),h=function getExternalEmail(){var e=i.a.getState().session;return Object(u.a)("",["endUser","externalEmail"],e)},y=function(){var e=Object(c.a)(r.a.mark(function _callee6(){var e,t,n,a,c;return r.a.wrap(function _callee6$(r){for(;;)switch(r.prev=r.next){case 0:if(!(p()&&!g())){r.next=7;break}return e=p(),r.next=5,m();case 5:t=r.sent,Object(b.c)(t,e)?E():t&&_();case 7:if(n=null,a=null,r.t0=g(),r.t0){r.next=14;break}return r.next=13,m();case 13:r.t0=r.sent;case 14:if((c=r.t0)&&!Object(b.b)(c)&&(a=c),!a){r.next=21;break}j(a),n=Object(b.a)(a),r.next=28;break;case 21:if(r.t1=p(),r.t1){r.next=26;break}return r.next=25,v();case 25:r.t1=r.sent;case 26:(n=r.t1)&&(O(n),_());case 28:return r.abrupt("return",{externalId:n,userJwt:a});case 29:case"end":return r.stop()}},_callee6)}));return function resolveExternalIdAndUserJwt(){return e.apply(this,arguments)}}(),C=function(){var e=Object(c.a)(r.a.mark(function _callee7(){var e,t,n,a,c,o,s;return r.a.wrap(function _callee7$(r){for(;;)switch(r.prev=r.next){case 0:if(!A()){r.next=10;break}return e=i.a.getState(),t=e.session,n=void 0===t?{}:t,a=Object(u.a)(!1,["endUser","waitForUserJwt"],n),r.next=6,y();case 6:return c=r.sent,o=c.externalId,s=c.userJwt,r.abrupt("return",a&&!s&&!!o);case 10:return r.abrupt("return",!1);case 11:case"end":return r.stop()}},_callee7)}));return function isWaitingForUserJwt(){return e.apply(this,arguments)}}(),A=function isSignedIdentityRequired(){var e=i.a.getState().embed,t=void 0===e?{}:e;return Object(u.a)(d.c.DISABLED,["configuration","theme","signedIdentityRequiredStatus"],t)===d.c.REQUIRED},S=function(){var e=Object(c.a)(r.a.mark(function _callee8(e){var t,n,a,c,o,s;return r.a.wrap(function _callee8$(r){for(;;)switch(r.prev=r.next){case 0:if(t=e.socketCluster,n=e.token,a=e.fn,!(c=Object(u.a)(null,["session","auth","socket","".concat(t)],i.a.getState()))){r.next=4;break}return r.abrupt("return",c);case 4:return r.next=6,a({access_token:n});case 6:if(o=r.sent,s=o.data){r.next=11;break}return Object(l.k)({type:"warn",data:["Empty payload response from ".concat(t," socket auth")]}),r.abrupt("return");case 11:return r.abrupt("return",s);case 12:case"end":return r.stop()}},_callee8)}));return function getAuthForSocketConnection(t){return e.apply(this,arguments)}}()}}]);